<!DOCTYPE html>
  <html>
    <head>
      <title>Pi0to Chromic</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">

      <link rel="stylesheet" href="file:////home/jo/.atom/packages/markdown-preview-enhanced/node_modules/@shd101wyy/mume/dependencies/katex/katex.min.css">
      <style>
      /**
 * prism.js Github theme based on GitHub's theme.
 * @author Sam Clarke
 */
code[class*="language-"],
pre[class*="language-"] {
  color: #333;
  background: none;
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.4;

  -moz-tab-size: 8;
  -o-tab-size: 8;
  tab-size: 8;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

/* Code blocks */
pre[class*="language-"] {
  padding: .8em;
  overflow: auto;
  /* border: 1px solid #ddd; */
  border-radius: 3px;
  /* background: #fff; */
  background: #f5f5f5;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
  padding: .1em;
  border-radius: .3em;
  white-space: normal;
  background: #f5f5f5;
}

.token.comment,
.token.blockquote {
  color: #969896;
}

.token.cdata {
  color: #183691;
}

.token.doctype,
.token.punctuation,
.token.variable,
.token.macro.property {
  color: #333;
}

.token.operator,
.token.important,
.token.keyword,
.token.rule,
.token.builtin {
  color: #a71d5d;
}

.token.string,
.token.url,
.token.regex,
.token.attr-value {
  color: #183691;
}

.token.property,
.token.number,
.token.boolean,
.token.entity,
.token.atrule,
.token.constant,
.token.symbol,
.token.command,
.token.code {
  color: #0086b3;
}

.token.tag,
.token.selector,
.token.prolog {
  color: #63a35c;
}

.token.function,
.token.namespace,
.token.pseudo-element,
.token.class,
.token.class-name,
.token.pseudo-class,
.token.id,
.token.url-reference .token.variable,
.token.attr-name {
  color: #795da3;
}

.token.entity {
  cursor: help;
}

.token.title,
.token.title .token.punctuation {
  font-weight: bold;
  color: #1d3e81;
}

.token.list {
  color: #ed6a43;
}

.token.inserted {
  background-color: #eaffea;
  color: #55a532;
}

.token.deleted {
  background-color: #ffecec;
  color: #bd2c00;
}

.token.bold {
  font-weight: bold;
}

.token.italic {
  font-style: italic;
}


/* JSON */
.language-json .token.property {
  color: #183691;
}

.language-markup .token.tag .token.punctuation {
  color: #333;
}

/* CSS */
code.language-css,
.language-css .token.function {
  color: #0086b3;
}

/* YAML */
.language-yaml .token.atrule {
  color: #63a35c;
}

code.language-yaml {
  color: #183691;
}

/* Ruby */
.language-ruby .token.function {
  color: #333;
}

/* Markdown */
.language-markdown .token.url {
  color: #795da3;
}

/* Makefile */
.language-makefile .token.symbol {
  color: #795da3;
}

.language-makefile .token.variable {
  color: #183691;
}

.language-makefile .token.builtin {
  color: #0086b3;
}

/* Bash */
.language-bash .token.keyword {
  color: #0086b3;
}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ul,html body>ol{margin-bottom:16px}html body ul,html body ol{padding-left:2em}html body ul.no-list,html body ol.no-list{padding:0;list-style-type:none}html body ul ul,html body ul ol,html body ol ol,html body ol ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:bold;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:bold}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em !important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::before,html body code::after{letter-spacing:-0.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em !important;word-break:normal;white-space:pre;background:transparent;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em !important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:before,html body pre tt:before,html body pre code:after,html body pre tt:after{content:normal}html body p,html body blockquote,html body ul,html body ol,html body dl,html body pre{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body pre,html body code{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .pagebreak,.markdown-preview .newpage{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center !important}.markdown-preview:not([for="preview"]) .code-chunk .btn-group{display:none}.markdown-preview:not([for="preview"]) .code-chunk .status{display:none}.markdown-preview:not([for="preview"]) .code-chunk .output-div{margin-bottom:16px}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0}@media screen and (min-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px)}}@media screen and (max-width:914px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode]) .markdown-preview{font-size:14px !important;padding:1em}}@media print{html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for="html-export"]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,0.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,0.66);border:4px solid rgba(150,150,150,0.66);background-clip:content-box}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{padding:0 1.6em;margin-top:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc li{margin-bottom:.8em}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc ul{list-style-type:none}html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% -  300px);padding:2em calc(50% - 457px -  150px);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for="html-export"]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for="html-export"]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}

      </style>
    </head>
    <body for="html-export">
      <div class="mume markdown-preview   ">
      <div><h1 class="mume-header" id="final-year-project"><strong>Final Year Project</strong></h1>

<p><img src="data:image/svg+xml;charset=utf-8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiCiAgIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxuczpzb2RpcG9kaT0iaHR0cDovL3NvZGlwb2RpLnNvdXJjZWZvcmdlLm5ldC9EVEQvc29kaXBvZGktMC5kdGQiCiAgIHhtbG5zOmlua3NjYXBlPSJodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy9uYW1lc3BhY2VzL2lua3NjYXBlIgogICB3aWR0aD0iMjAwIgogICBoZWlnaHQ9IjEyMC45NTcwMyIKICAgdmlld0JveD0iMCAwIDUyLjkxNjY2NiAzMi4wMDMyMTYiCiAgIHZlcnNpb249IjEuMSIKICAgaWQ9InN2ZzgiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTIuMiAoNWMzZTgwZCwgMjAxNy0wOC0wNikiCiAgIHNvZGlwb2RpOmRvY25hbWU9InBpMHRvQ2hyb21hLnN2ZyI+CiAgPGRlZnMKICAgICBpZD0iZGVmczIiIC8+CiAgPHNvZGlwb2RpOm5hbWVkdmlldwogICAgIGlkPSJiYXNlIgogICAgIHBhZ2Vjb2xvcj0iI2ZmZmZmZiIKICAgICBib3JkZXJjb2xvcj0iIzY2NjY2NiIKICAgICBib3JkZXJvcGFjaXR5PSIxLjAiCiAgICAgaW5rc2NhcGU6cGFnZW9wYWNpdHk9IjAuMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOnpvb209IjQuNTMxMjUiCiAgICAgaW5rc2NhcGU6Y3g9Ijk3LjUxOTI4MyIKICAgICBpbmtzY2FwZTpjeT0iMzEuNDI4Njk2IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJtbSIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9ImZhbHNlIgogICAgIHVuaXRzPSJweCIKICAgICBpbmtzY2FwZTp3aW5kb3ctd2lkdGg9IjE5MjAiCiAgICAgaW5rc2NhcGU6d2luZG93LWhlaWdodD0iMTA1NiIKICAgICBpbmtzY2FwZTp3aW5kb3cteD0iMTM2NiIKICAgICBpbmtzY2FwZTp3aW5kb3cteT0iMjQiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMSIKICAgICBpbmtzY2FwZTpzbmFwLW9iamVjdC1taWRwb2ludHM9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmJib3gtcGF0aHM9InRydWUiCiAgICAgaW5rc2NhcGU6YmJveC1ub2Rlcz0idHJ1ZSIKICAgICBpbmtzY2FwZTpzbmFwLWJib3gtZWRnZS1taWRwb2ludHM9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC1iYm94LW1pZHBvaW50cz0idHJ1ZSIKICAgICBpbmtzY2FwZTpzbmFwLWNlbnRlcj0idHJ1ZSIKICAgICBpbmtzY2FwZTpzbmFwLXRleHQtYmFzZWxpbmU9InRydWUiCiAgICAgaW5rc2NhcGU6b2JqZWN0LXBhdGhzPSJ0cnVlIgogICAgIGlua3NjYXBlOnNuYXAtaW50ZXJzZWN0aW9uLXBhdGhzPSJ0cnVlIgogICAgIGlua3NjYXBlOnNuYXAtc21vb3RoLW5vZGVzPSJ0cnVlIgogICAgIGlua3NjYXBlOnNuYXAtbWlkcG9pbnRzPSJ0cnVlIgogICAgIGlua3NjYXBlOnNuYXAtcGFnZT0idHJ1ZSIKICAgICBmaXQtbWFyZ2luLXRvcD0iMjAiCiAgICAgZml0LW1hcmdpbi1sZWZ0PSIyMCIKICAgICBmaXQtbWFyZ2luLXJpZ2h0PSIyMCIKICAgICBmaXQtbWFyZ2luLWJvdHRvbT0iMjAiIC8+CiAgPG1ldGFkYXRhCiAgICAgaWQ9Im1ldGFkYXRhNSI+CiAgICA8cmRmOlJERj4KICAgICAgPGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPgogICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PgogICAgICAgIDxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz4KICAgICAgICA8ZGM6dGl0bGU+PC9kYzp0aXRsZT4KICAgICAgPC9jYzpXb3JrPgogICAgPC9yZGY6UkRGPgogIDwvbWV0YWRhdGE+CiAgPGcKICAgICBpbmtzY2FwZTpsYWJlbD0iTGF5ZXIgMSIKICAgICBpbmtzY2FwZTpncm91cG1vZGU9ImxheWVyIgogICAgIGlkPSJsYXllcjEiCiAgICAgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNS4zNDc0NzYyLC0yNTYuMzc4OTQpIj4KICAgIDx0ZXh0CiAgICAgICB4bWw6c3BhY2U9InByZXNlcnZlIgogICAgICAgc3R5bGU9ImZvbnQtc3R5bGU6bm9ybWFsO2ZvbnQtd2VpZ2h0Om5vcm1hbDtmb250LXNpemU6MTAuNTI5NDg2NjZweDtsaW5lLWhlaWdodDoxMjUlO2ZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7dGV4dC1hbGlnbjpjZW50ZXI7bGV0dGVyLXNwYWNpbmc6MHB4O3dvcmQtc3BhY2luZzowcHg7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MC4yNjMyMzcxNXB4O3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICB4PSIyMS4yNTQ4MDUiCiAgICAgICB5PSIyNjguMzM5MiIKICAgICAgIGlkPSJ0ZXh0ODE3IgogICAgICAgdHJhbnNmb3JtPSJzY2FsZSgwLjk5NDkxMjE0LDEuMDA1MTEzOSkiPjx0c3BhbgogICAgICAgICBzb2RpcG9kaTpyb2xlPSJsaW5lIgogICAgICAgICBpZD0idHNwYW44MTUiCiAgICAgICAgIHg9IjIxLjI1NDgwNSIKICAgICAgICAgeT0iMjY4LjMzOTIiCiAgICAgICAgIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjt0ZXh0LWFuY2hvcjptaWRkbGU7ZmlsbDojNTg2ZTc1O2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjI2MzIzNzE1cHgiPlBpMHRvPC90c3Bhbj48dHNwYW4KICAgICAgICAgc29kaXBvZGk6cm9sZT0ibGluZSIKICAgICAgICAgeD0iMjEuMjU0ODA1IgogICAgICAgICB5PSIyODEuNTAxMDciCiAgICAgICAgIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjt0ZXh0LWFuY2hvcjptaWRkbGU7c3Ryb2tlLXdpZHRoOjAuMjYzMjM3MTVweCIKICAgICAgICAgaWQ9InRzcGFuODE5Ij48dHNwYW4KICAgICAgICAgICBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6I2RjMzIyZjtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yNjMyMzcxNXB4IgogICAgICAgICAgIGlkPSJ0c3BhbjgyMSI+QzwvdHNwYW4+PHRzcGFuCiAgICAgICAgICAgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3RleHQtYW5jaG9yOm1pZGRsZTtmaWxsOiNkMzM2ODI7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjYzMjM3MTVweCIKICAgICAgICAgICBpZD0idHNwYW44NjMiPmg8L3RzcGFuPjx0c3BhbgogICAgICAgICAgIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjt0ZXh0LWFuY2hvcjptaWRkbGU7ZmlsbDojNmM3MWM0O2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjI2MzIzNzE1cHgiCiAgICAgICAgICAgaWQ9InRzcGFuODY5Ij5yPC90c3Bhbj48dHNwYW4KICAgICAgICAgICBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6IzI2OGJkMjtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yNjMyMzcxNXB4IgogICAgICAgICAgIGlkPSJ0c3Bhbjg3NSI+bzwvdHNwYW4+PHRzcGFuCiAgICAgICAgICAgc3R5bGU9InRleHQtYWxpZ246Y2VudGVyO3RleHQtYW5jaG9yOm1pZGRsZTtmaWxsOiMyYWExOTg7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlLXdpZHRoOjAuMjYzMjM3MTVweCIKICAgICAgICAgICBpZD0idHNwYW44ODEiPm08L3RzcGFuPjx0c3BhbgogICAgICAgICAgIHN0eWxlPSJ0ZXh0LWFsaWduOmNlbnRlcjt0ZXh0LWFuY2hvcjptaWRkbGU7ZmlsbDojODU5OTAwO2ZpbGwtb3BhY2l0eToxO3N0cm9rZS13aWR0aDowLjI2MzIzNzE1cHgiCiAgICAgICAgICAgaWQ9InRzcGFuODg3Ij5pPC90c3Bhbj48dHNwYW4KICAgICAgICAgICBzdHlsZT0idGV4dC1hbGlnbjpjZW50ZXI7dGV4dC1hbmNob3I6bWlkZGxlO2ZpbGw6I2I1ODkwMDtmaWxsLW9wYWNpdHk6MTtzdHJva2Utd2lkdGg6MC4yNjMyMzcxNXB4IgogICAgICAgICAgIGlkPSJ0c3BhbjgyNSI+YzwvdHNwYW4+PC90c3Bhbj48L3RleHQ+CiAgPC9nPgo8L3N2Zz4K" alt="pi0toChroma logo"></p>
<p>By David Joseph Hawkins</p>
<p>A report submitted to the University of Plymouth in partial fulfilment for the degree of BEng(Hons) Electrical and Electronic Engineering.</p>
<h1 class="mume-header" id="stage-criteria">Stage Criteria</h1>

<p>This is the criteria I would like to meet, to feel as though I have created a successful project.</p>
<table>
<thead>
<tr>
<th>Stage</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Smart shades</td>
<td>Make a set of smart sun classes</td>
</tr>
<tr>
<td>2</td>
<td>Auto smart shades</td>
<td>Add LDR to control the opacity</td>
</tr>
<tr>
<td>3</td>
<td>Auto smart point shades</td>
<td>Add camera to make dark point over bright points</td>
</tr>
<tr>
<td>4</td>
<td>Controllable smart shades</td>
<td>Add options to swap between modes</td>
</tr>
<tr>
<td>5</td>
<td>Driving/safety improvements</td>
<td>Auto react headlights etc.</td>
</tr>
</tbody>
</table>
<h2 class="mume-header" id="inspiration">Inspiration</h2>

<p><a href="https://www.indiegogo.com/projects/ctrl-one-the-smartest-lcd-tint-changing-glasses-smart#/">indie-go-go</a></p>
<p><a href="http://www.ctrl-eyewear.com/">ctrl-eyewear</a></p>
<p><a href="https://www.youtube.com/watch?v=E5d7ynJXiZc">pc case</a></p>
<h2 class="mume-header" id="plan">Plan</h2>

<p>The product’s above, along with Paul’s lectures last year inspired my idea.</p>
<p>The plan is to use two LCD’s with the backlight removed, to create dimmable panels in front of the users eyes. Then eventually I will add a camera to make point control which will block bright spots such as projectors and the sun, and dim them to reduce squinting.</p>
<h1 class="mume-header" id="final-mock-up">Final mock-up</h1>

<p><img src="data:image/svg+xml;charset=utf-8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gQ3JlYXRlZCB3aXRoIElua3NjYXBlIChodHRwOi8vd3d3Lmlua3NjYXBlLm9yZy8pIC0tPgoKPHN2ZwogICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiCiAgIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyIKICAgeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogICB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgd2lkdGg9IjI5Ni4zOTU1N21tIgogICBoZWlnaHQ9IjEwOS44NDA4N21tIgogICB2aWV3Qm94PSIwIDAgMjk2LjM5NTU3IDEwOS44NDA4OCIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0ic3ZnOCIKICAgaW5rc2NhcGU6dmVyc2lvbj0iMC45Mi4xIHIxNTM3MSIKICAgc29kaXBvZGk6ZG9jbmFtZT0iZmluYWxfZGVzaWduX3BsYW4uc3ZnIj4KICA8ZGVmcwogICAgIGlkPSJkZWZzMiI+CiAgICA8bGluZWFyR3JhZGllbnQKICAgICAgIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyIKICAgICAgIGlkPSJsaW5lYXJHcmFkaWVudDQ1MTIiPgogICAgICA8c3RvcAogICAgICAgICBzdHlsZT0ic3RvcC1jb2xvcjojMDAwMDAwO3N0b3Atb3BhY2l0eToxOyIKICAgICAgICAgb2Zmc2V0PSIwIgogICAgICAgICBpZD0ic3RvcDQ1MDgiIC8+CiAgICAgIDxzdG9wCiAgICAgICAgIHN0eWxlPSJzdG9wLWNvbG9yOiMwMDAwMDA7c3RvcC1vcGFjaXR5OjA7IgogICAgICAgICBvZmZzZXQ9IjEiCiAgICAgICAgIGlkPSJzdG9wNDUxMCIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8bGluZWFyR3JhZGllbnQKICAgICAgIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyIKICAgICAgIGlkPSJsaW5lYXJHcmFkaWVudDUxNTQiPgogICAgICA8c3RvcAogICAgICAgICBzdHlsZT0ic3RvcC1jb2xvcjojZmZmYWZhO3N0b3Atb3BhY2l0eToxOyIKICAgICAgICAgb2Zmc2V0PSIwIgogICAgICAgICBpZD0ic3RvcDUxNTAiIC8+CiAgICAgIDxzdG9wCiAgICAgICAgIHN0eWxlPSJzdG9wLWNvbG9yOiNmZmZhZmE7c3RvcC1vcGFjaXR5OjA7IgogICAgICAgICBvZmZzZXQ9IjEiCiAgICAgICAgIGlkPSJzdG9wNTE1MiIgLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8aW5rc2NhcGU6cGF0aC1lZmZlY3QKICAgICAgIGVmZmVjdD0iYnNwbGluZSIKICAgICAgIGlkPSJwYXRoLWVmZmVjdDQ2MDMiCiAgICAgICBpc192aXNpYmxlPSJ0cnVlIgogICAgICAgd2VpZ2h0PSIzMy4zMzMzMzMiCiAgICAgICBzdGVwcz0iMiIKICAgICAgIGhlbHBlcl9zaXplPSIwIgogICAgICAgYXBwbHlfbm9fd2VpZ2h0PSJ0cnVlIgogICAgICAgYXBwbHlfd2l0aF93ZWlnaHQ9InRydWUiCiAgICAgICBvbmx5X3NlbGVjdGVkPSJmYWxzZSIgLz4KICAgIDxpbmtzY2FwZTpwYXRoLWVmZmVjdAogICAgICAgZWZmZWN0PSJic3BsaW5lIgogICAgICAgaWQ9InBhdGgtZWZmZWN0NDU4MSIKICAgICAgIGlzX3Zpc2libGU9InRydWUiCiAgICAgICB3ZWlnaHQ9IjMzLjMzMzMzMyIKICAgICAgIHN0ZXBzPSIyIgogICAgICAgaGVscGVyX3NpemU9IjAiCiAgICAgICBhcHBseV9ub193ZWlnaHQ9InRydWUiCiAgICAgICBhcHBseV93aXRoX3dlaWdodD0idHJ1ZSIKICAgICAgIG9ubHlfc2VsZWN0ZWQ9ImZhbHNlIiAvPgogICAgPGlua3NjYXBlOnBhdGgtZWZmZWN0CiAgICAgICBlZmZlY3Q9ImJzcGxpbmUiCiAgICAgICBpZD0icGF0aC1lZmZlY3Q0NTY3IgogICAgICAgaXNfdmlzaWJsZT0idHJ1ZSIKICAgICAgIHdlaWdodD0iMzMuMzMzMzMzIgogICAgICAgc3RlcHM9IjIiCiAgICAgICBoZWxwZXJfc2l6ZT0iMCIKICAgICAgIGFwcGx5X25vX3dlaWdodD0idHJ1ZSIKICAgICAgIGFwcGx5X3dpdGhfd2VpZ2h0PSJ0cnVlIgogICAgICAgb25seV9zZWxlY3RlZD0iZmFsc2UiIC8+CiAgICA8aW5rc2NhcGU6cGF0aC1lZmZlY3QKICAgICAgIGVmZmVjdD0iYnNwbGluZSIKICAgICAgIGlkPSJwYXRoLWVmZmVjdDQ1ODEtNyIKICAgICAgIGlzX3Zpc2libGU9InRydWUiCiAgICAgICB3ZWlnaHQ9IjMzLjMzMzMzMyIKICAgICAgIHN0ZXBzPSIyIgogICAgICAgaGVscGVyX3NpemU9IjAiCiAgICAgICBhcHBseV9ub193ZWlnaHQ9InRydWUiCiAgICAgICBhcHBseV93aXRoX3dlaWdodD0idHJ1ZSIKICAgICAgIG9ubHlfc2VsZWN0ZWQ9ImZhbHNlIiAvPgogICAgPGlua3NjYXBlOnBhdGgtZWZmZWN0CiAgICAgICBlZmZlY3Q9ImJzcGxpbmUiCiAgICAgICBpZD0icGF0aC1lZmZlY3Q0NjAzLTMiCiAgICAgICBpc192aXNpYmxlPSJ0cnVlIgogICAgICAgd2VpZ2h0PSIzMy4zMzMzMzMiCiAgICAgICBzdGVwcz0iMiIKICAgICAgIGhlbHBlcl9zaXplPSIwIgogICAgICAgYXBwbHlfbm9fd2VpZ2h0PSJ0cnVlIgogICAgICAgYXBwbHlfd2l0aF93ZWlnaHQ9InRydWUiCiAgICAgICBvbmx5X3NlbGVjdGVkPSJmYWxzZSIgLz4KICAgIDxyYWRpYWxHcmFkaWVudAogICAgICAgaW5rc2NhcGU6Y29sbGVjdD0iYWx3YXlzIgogICAgICAgeGxpbms6aHJlZj0iI2xpbmVhckdyYWRpZW50NTE1NCIKICAgICAgIGlkPSJyYWRpYWxHcmFkaWVudDUxNTYiCiAgICAgICBjeD0iMTAwLjEwNjMxIgogICAgICAgY3k9IjIyLjU4OTg0OSIKICAgICAgIGZ4PSIxMDAuMTA2MzEiCiAgICAgICBmeT0iMjIuNTg5ODQ5IgogICAgICAgcj0iNS4wNjQ2OTgyIgogICAgICAgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwwLjcwOTY3NzQxLDAsNi41NTgzNDM1KSIKICAgICAgIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiAvPgogICAgPHJhZGlhbEdyYWRpZW50CiAgICAgICBpbmtzY2FwZTpjb2xsZWN0PSJhbHdheXMiCiAgICAgICB4bGluazpocmVmPSIjbGluZWFyR3JhZGllbnQ0NTEyIgogICAgICAgaWQ9InJhZGlhbEdyYWRpZW50NDUxNCIKICAgICAgIGN4PSIxMzcuMDczMzMiCiAgICAgICBjeT0iMjkuNTk2NDY4IgogICAgICAgZng9IjEzNy4wNzMzMyIKICAgICAgIGZ5PSIyOS41OTY0NjgiCiAgICAgICByPSIxMC44NDgwMDciCiAgICAgICBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDAuMzU0ODM4NzQsMCwxOS4wOTQ0OTUpIgogICAgICAgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIC8+CiAgICA8cmFkaWFsR3JhZGllbnQKICAgICAgIGlua3NjYXBlOmNvbGxlY3Q9ImFsd2F5cyIKICAgICAgIHhsaW5rOmhyZWY9IiNsaW5lYXJHcmFkaWVudDQ1MTIiCiAgICAgICBpZD0icmFkaWFsR3JhZGllbnQ0NTE2IgogICAgICAgY3g9IjIxLjQxOTU2NyIKICAgICAgIGN5PSIyNy42NzE4MjQiCiAgICAgICBmeD0iMjEuNDE5NTY3IgogICAgICAgZnk9IjI3LjY3MTgyNCIKICAgICAgIHI9IjEwLjY3MzA0IgogICAgICAgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwwLjM3NzA0OTEyLDAsMTcuMjM4MTg3KSIKICAgICAgIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiAvPgogICAgPHJhZGlhbEdyYWRpZW50CiAgICAgICBpbmtzY2FwZTpjb2xsZWN0PSJhbHdheXMiCiAgICAgICB4bGluazpocmVmPSIjbGluZWFyR3JhZGllbnQ0NTEyIgogICAgICAgaWQ9InJhZGlhbEdyYWRpZW50NDUxNC0zIgogICAgICAgY3g9IjEzNy4wNzMzMyIKICAgICAgIGN5PSIyOS41OTY0NjgiCiAgICAgICBmeD0iMTM3LjA3MzMzIgogICAgICAgZnk9IjI5LjU5NjQ2OCIKICAgICAgIHI9IjEwLjg0ODAwNyIKICAgICAgIGdyYWRpZW50VHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMC4zNTQ4Mzg3NCw0My4zOTIwMjMsMzkuMDQwODM2KSIKICAgICAgIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIiAvPgogICAgPHJhZGlhbEdyYWRpZW50CiAgICAgICBpbmtzY2FwZTpjb2xsZWN0PSJhbHdheXMiCiAgICAgICB4bGluazpocmVmPSIjbGluZWFyR3JhZGllbnQ0NTEyIgogICAgICAgaWQ9InJhZGlhbEdyYWRpZW50NDUxNi01IgogICAgICAgY3g9IjIxLjQxOTU2NyIKICAgICAgIGN5PSIyNy42NzE4MjQiCiAgICAgICBmeD0iMjEuNDE5NTY3IgogICAgICAgZnk9IjI3LjY3MTgyNCIKICAgICAgIHI9IjEwLjY3MzA0IgogICAgICAgZ3JhZGllbnRUcmFuc2Zvcm09Im1hdHJpeCgxLDAsMCwwLjM3NzA0OTEzLDQzLjM5MjAyMywzNy4xODQ1MjgpIgogICAgICAgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIC8+CiAgPC9kZWZzPgogIDxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBpZD0iYmFzZSIKICAgICBwYWdlY29sb3I9IiNmZmZmZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMS4wIgogICAgIGlua3NjYXBlOnBhZ2VvcGFjaXR5PSIwLjAiCiAgICAgaW5rc2NhcGU6cGFnZXNoYWRvdz0iMiIKICAgICBpbmtzY2FwZTp6b29tPSIyLjEzODU0ODkiCiAgICAgaW5rc2NhcGU6Y3g9IjM2MC4yODI5NCIKICAgICBpbmtzY2FwZTpjeT0iNjYuNzc2MjY3IgogICAgIGlua3NjYXBlOmRvY3VtZW50LXVuaXRzPSJtbSIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJsYXllcjEiCiAgICAgc2hvd2dyaWQ9ImZhbHNlIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTM2NiIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI3NDQiCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjI0IgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjEiCiAgICAgaW5rc2NhcGU6c25hcC1iYm94PSJ0cnVlIgogICAgIGlua3NjYXBlOmJib3gtcGF0aHM9InRydWUiCiAgICAgaW5rc2NhcGU6YmJveC1ub2Rlcz0idHJ1ZSIKICAgICBpbmtzY2FwZTpzbmFwLWJib3gtZWRnZS1taWRwb2ludHM9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC1iYm94LW1pZHBvaW50cz0idHJ1ZSIKICAgICBpbmtzY2FwZTpzbmFwLW9iamVjdC1taWRwb2ludHM9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC1jZW50ZXI9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC1pbnRlcnNlY3Rpb24tcGF0aHM9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC1taWRwb2ludHM9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC1ncmlkcz0idHJ1ZSIKICAgICBpbmtzY2FwZTpvYmplY3QtcGF0aHM9InRydWUiCiAgICAgaW5rc2NhcGU6c25hcC10ZXh0LWJhc2VsaW5lPSJ0cnVlIgogICAgIGZpdC1tYXJnaW4tdG9wPSIwIgogICAgIGZpdC1tYXJnaW4tbGVmdD0iMCIKICAgICBmaXQtbWFyZ2luLXJpZ2h0PSIwIgogICAgIGZpdC1tYXJnaW4tYm90dG9tPSIwIgogICAgIGlua3NjYXBlOnNuYXAtZ2xvYmFsPSJmYWxzZSIgLz4KICA8bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGE1Ij4KICAgIDxyZGY6UkRGPgogICAgICA8Y2M6V29yawogICAgICAgICByZGY6YWJvdXQ9IiI+CiAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9zdmcreG1sPC9kYzpmb3JtYXQ+CiAgICAgICAgPGRjOnR5cGUKICAgICAgICAgICByZGY6cmVzb3VyY2U9Imh0dHA6Ly9wdXJsLm9yZy9kYy9kY21pdHlwZS9TdGlsbEltYWdlIiAvPgogICAgICAgIDxkYzp0aXRsZSAvPgogICAgICA8L2NjOldvcms+CiAgICA8L3JkZjpSREY+CiAgPC9tZXRhZGF0YT4KICA8ZwogICAgIGlua3NjYXBlOmxhYmVsPSJMYXllciAxIgogICAgIGlua3NjYXBlOmdyb3VwbW9kZT0ibGF5ZXIiCiAgICAgaWQ9ImxheWVyMSIKICAgICB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNC43OTc2MTg5LDUwLjg0OTc5OSkiPgogICAgPHJlY3QKICAgICAgIHN0eWxlPSJvcGFjaXR5OjAuOTg5OTk5OTk7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eTowLjMyNTk2Njg3O3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjU7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxO3BhaW50LW9yZGVyOm5vcm1hbCIKICAgICAgIGlkPSJyZWN0NDQ4NSIKICAgICAgIHdpZHRoPSI3OS43NTI5NzUiCiAgICAgICBoZWlnaHQ9IjM5LjMwOTUyNSIKICAgICAgIHg9IjYuMDQ3NjE4OSIKICAgICAgIHk9IjE4LjQzMTU0NyIKICAgICAgIHJ5PSIwIiAvPgogICAgPHJlY3QKICAgICAgIHN0eWxlPSJvcGFjaXR5OjAuOTg5OTk5OTk7ZmlsbDojMDAwMDAwO2ZpbGwtb3BhY2l0eTowLjMyNTk2Njg3O3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoyLjU7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxO3BhaW50LW9yZGVyOm5vcm1hbCIKICAgICAgIGlkPSJyZWN0NDQ4NS0zIgogICAgICAgd2lkdGg9Ijc5Ljc1Mjk3NSIKICAgICAgIGhlaWdodD0iMzkuMzA5NTI1IgogICAgICAgeD0iMTE1LjI4ODEyIgogICAgICAgeT0iMTguNDMxNTQ3IgogICAgICAgcnk9IjAiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTA7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46bWl0ZXI7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICAgIGQ9Im0gODUuODAwNTk4LDIyLjM1MjYwNCBjIDkuODI5NDM1LDAgMTkuNjU4NjEyLDAgMjkuNDg3NTEyLDAiCiAgICAgICBpZD0icGF0aDQ1NjUiCiAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIgogICAgICAgaW5rc2NhcGU6cGF0aC1lZmZlY3Q9IiNwYXRoLWVmZmVjdDQ1NjciCiAgICAgICBpbmtzY2FwZTpvcmlnaW5hbC1kPSJtIDg1LjgwMDU5OCwyMi4zNTI2MDQgYyA5LjgyOTQzNSwtMi42NWUtNCAxOS42NTg2MTIsLTIuNjVlLTQgMjkuNDg3NTEyLDAiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSA2LjA0NzYxODksMTguNDMxNTQ3IEMgMzMuNTM1ODI5LC01LjcxNDE5NjIgNjEuMDIzNzU5LC0yOS44NTk2OTQgNzguNjkzOTA0LC00MC44NzMwNiBjIDE3LjY3MDE0NSwtMTEuMDEzMzY3IDI1LjUyMjc3NiwtOC44OTQ4NTMgMzMuMzc1MTI2LC02Ljc3NjQxMiIKICAgICAgIGlkPSJwYXRoNDU3OSIKICAgICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgICBpbmtzY2FwZTpwYXRoLWVmZmVjdD0iI3BhdGgtZWZmZWN0NDU4MSIKICAgICAgIGlua3NjYXBlOm9yaWdpbmFsLWQ9Ik0gNi4wNDc2MTg5LDE4LjQzMTU0NyBDIDMzLjUzNTgxMywtNS43MTQyMTQyIDYxLjAyMzc0MywtMjkuODU5NzEyIDg4LjUxMTQwOSwtNTQuMDA0OTQ1IGMgNy44NTI3MjQsMi4xMTgyMDUgMTUuNzA1MzUxLDQuMjM2NzE3IDIzLjU1NzYyMSw2LjM1NTQ3MyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJtIDE5NC43ODEwNywxOS42OTcyODcgYyAyNy40ODgyMSwtMjQuMTQ1NzQxNCA1NC45NzYxNCwtNDguMjkxMjQgNzIuNjQ2MjgsLTU5LjMwNDYwOCAxNy42NzAxNSwtMTEuMDEzMzY4IDI1LjUyMjc4LC04Ljg5NDg1MyAzMy4zNzUxMywtNi43NzY0MTIiCiAgICAgICBpZD0icGF0aDQ1NzktNSIKICAgICAgIGlua3NjYXBlOmNvbm5lY3Rvci1jdXJ2YXR1cmU9IjAiCiAgICAgICBpbmtzY2FwZTpwYXRoLWVmZmVjdD0iI3BhdGgtZWZmZWN0NDU4MS03IgogICAgICAgaW5rc2NhcGU6b3JpZ2luYWwtZD0ibSAxOTQuNzgxMDcsMTkuNjk3Mjg3IGMgMjcuNDg4MTksLTI0LjE0NTc2MTQgNTQuOTc2MTIsLTQ4LjI5MTI2IDgyLjQ2Mzc5LC03Mi40MzY0OTMgNy44NTI3MiwyLjExODIwNSAxNS43MDUzNSw0LjIzNjcxNyAyMy41NTc2Miw2LjM1NTQ3MyIgLz4KICAgIDxwYXRoCiAgICAgICBzdHlsZT0iZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpldmVub2RkO3N0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDozO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOm1pdGVyO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1vcGFjaXR5OjEiCiAgICAgICBkPSJNIDE5NS4wNDEwOSwzOC4wODYzMDkgQyAyMDkuMjg1NTcsMjQuMjUwOTE4IDIyMy41Mjk3OSwxMC40MTU3ODUgMjMyLjA2MTEyLDAuMDMyNzE1ODYgMjQwLjU5MjQ1LC0xMC4zNTAzNTMgMjQzLjQxMTE0LC0xNy4yODE1NjcgMjQ2LjIyOTY0LC0yNC4yMTIzMjkiCiAgICAgICBpZD0icGF0aDQ2MDEiCiAgICAgICBpbmtzY2FwZTpjb25uZWN0b3ItY3VydmF0dXJlPSIwIgogICAgICAgaW5rc2NhcGU6cGF0aC1lZmZlY3Q9IiNwYXRoLWVmZmVjdDQ2MDMiCiAgICAgICBpbmtzY2FwZTpvcmlnaW5hbC1kPSJtIDE5NS4wNDEwOSwzOC4wODYzMDkgYyAxNC4yNDQ0OCwtMTMuODM1Mzk2IDI4LjQ4ODcsLTI3LjY3MDUyNyA0Mi43MzI2NSwtNDEuNTA1MzkzNyAyLjgxODg0LC02LjkzMTIxNTMgNS42Mzc1MywtMTMuODYyNDI4MyA4LjQ1NTksLTIwLjc5MzI0NDMiIC8+CiAgICA8cGF0aAogICAgICAgc3R5bGU9ImZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6ZXZlbm9kZDtzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjptaXRlcjtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2Utb3BhY2l0eToxIgogICAgICAgZD0iTSA1Ljg0MjcxNTcsMzcuMDEwMzExIEMgMjAuMDg3MiwyMy4xNzQ5MTkgMzQuMzMxNDE4LDkuMzM5Nzg2NSA0Mi44NjI3NDcsLTEuMDQzMjgzMyA1MS4zOTQwNzYsLTExLjQyNjM1MyA1NC4yMTI3NjMsLTE4LjM1NzU2NyA1Ny4wMzEyNjYsLTI1LjI4ODMyOSIKICAgICAgIGlkPSJwYXRoNDYwMS01IgogICAgICAgaW5rc2NhcGU6Y29ubmVjdG9yLWN1cnZhdHVyZT0iMCIKICAgICAgIGlua3NjYXBlOnBhdGgtZWZmZWN0PSIjcGF0aC1lZmZlY3Q0NjAzLTMiCiAgICAgICBpbmtzY2FwZTpvcmlnaW5hbC1kPSJNIDUuODQyNzE1NywzNy4wMTAzMTEgQyAyMC4wODcxOTYsMjMuMTc0OTE1IDM0LjMzMTQxNiw5LjMzOTc4NCA0OC41NzUzNjYsLTQuNDk1MDgzNyBjIDIuODE4ODQsLTYuOTMxMjE2MyA1LjYzNzUzLC0xMy44NjI0MjkzIDguNDU1OSwtMjAuNzkzMjQ1MyIgLz4KICAgIDxlbGxpcHNlCiAgICAgICBzdHlsZT0ib3BhY2l0eTowLjk4OTk5OTk5O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MC4zMjU5NjY4NztzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS4xMzczOTc3NztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjE7cGFpbnQtb3JkZXI6bm9ybWFsIgogICAgICAgaWQ9InBhdGg0NjMxIgogICAgICAgY3g9IjIwMy4xMzc3MyIKICAgICAgIGN5PSIyMS4wODc1MjEiCiAgICAgICByeD0iMy4yMTg1ODQ4IgogICAgICAgcnk9IjMuMjE4NTg0MSIgLz4KICAgIDxlbGxpcHNlCiAgICAgICBzdHlsZT0ib3BhY2l0eTowLjk4OTk5OTk5O2ZpbGw6IzAwMDAwMDtmaWxsLW9wYWNpdHk6MC4zMjU5NjY4NztzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS4xMzczOTc3NztzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjE7cGFpbnQtb3JkZXI6bm9ybWFsIgogICAgICAgaWQ9InBhdGg0NjMxLTYiCiAgICAgICBjeD0iMjEwLjY1MzExIgogICAgICAgY3k9IjE0LjIyNTY3IgogICAgICAgcng9IjMuMjE4NTg0OCIKICAgICAgIHJ5PSIzLjIxODU4NDEiIC8+CiAgICA8ZWxsaXBzZQogICAgICAgc3R5bGU9Im9wYWNpdHk6MC45ODk5OTk5OTtmaWxsOiMwMDAwMDA7ZmlsbC1vcGFjaXR5OjAuMzI1OTY2ODc7c3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuMTM3Mzk3Nzc7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxO3BhaW50LW9yZGVyOm5vcm1hbCIKICAgICAgIGlkPSJwYXRoNDYzMS02LTIiCiAgICAgICBjeD0iMjE3Ljg0MTcxIgogICAgICAgY3k9IjcuMDM3MDY2IgogICAgICAgcng9IjMuMjE4NTg0OCIKICAgICAgIHJ5PSIzLjIxODU4NDEiIC8+CiAgICA8ZWxsaXBzZQogICAgICAgc3R5bGU9Im9wYWNpdHk6MC45ODY7ZmlsbDp1cmwoI3JhZGlhbEdyYWRpZW50NTE1Nik7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjEwO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MDtwYWludC1vcmRlcjpub3JtYWwiCiAgICAgICBpZD0icGF0aDQ2ODQiCiAgICAgICBjeD0iMTAwLjEwNjMxIgogICAgICAgY3k9IjIyLjU4OTg0OSIKICAgICAgIHJ4PSI1LjA2NDY5ODIiCiAgICAgICByeT0iMy41OTQzMDE5IiAvPgogICAgPGVsbGlwc2UKICAgICAgIHN0eWxlPSJvcGFjaXR5OjAuOTg2MDAwMDM7ZmlsbDp1cmwoI3JhZGlhbEdyYWRpZW50NDUxNik7ZmlsbC1vcGFjaXR5OjE7c3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjEwO3N0cm9rZS1saW5lY2FwOmJ1dHQ7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MDtwYWludC1vcmRlcjpub3JtYWwiCiAgICAgICBpZD0icGF0aDQ1MDIiCiAgICAgICBjeD0iMjEuNDE5NTY3IgogICAgICAgY3k9IjI3LjY3MTgyNCIKICAgICAgIHJ4PSIxMC42NzMwNCIKICAgICAgIHJ5PSI0LjAyNDI2MDUiIC8+CiAgICA8ZWxsaXBzZQogICAgICAgc3R5bGU9Im9wYWNpdHk6MC45ODYwMDAwMztmaWxsOnVybCgjcmFkaWFsR3JhZGllbnQ0NTE0KTtmaWxsLW9wYWNpdHk6MTtzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTA7c3Ryb2tlLWxpbmVjYXA6YnV0dDtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eTowO3BhaW50LW9yZGVyOm5vcm1hbCIKICAgICAgIGlkPSJwYXRoNDUwNCIKICAgICAgIGN4PSIxMzcuMDczMzMiCiAgICAgICBjeT0iMjkuNTk2NDY4IgogICAgICAgcng9IjEwLjg0ODAwNyIKICAgICAgIHJ5PSIzLjg0OTI5MzIiIC8+CiAgICA8ZWxsaXBzZQogICAgICAgc3R5bGU9Im9wYWNpdHk6MC45ODYwMDAwMztmaWxsOnVybCgjcmFkaWFsR3JhZGllbnQ0NTE2LTUpO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxMDtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjA7cGFpbnQtb3JkZXI6bm9ybWFsIgogICAgICAgaWQ9InBhdGg0NTAyLTMiCiAgICAgICBjeD0iNjQuODExNTg0IgogICAgICAgY3k9IjQ3LjYxODE2NCIKICAgICAgIHJ4PSIxMC42NzMwNCIKICAgICAgIHJ5PSI0LjAyNDI2MDUiIC8+CiAgICA8ZWxsaXBzZQogICAgICAgc3R5bGU9Im9wYWNpdHk6MC45ODYwMDAwMztmaWxsOnVybCgjcmFkaWFsR3JhZGllbnQ0NTE0LTMpO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxMDtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjA7cGFpbnQtb3JkZXI6bm9ybWFsIgogICAgICAgaWQ9InBhdGg0NTA0LTUiCiAgICAgICBjeD0iMTgwLjQ2NTM2IgogICAgICAgY3k9IjQ5LjU0MjgwOSIKICAgICAgIHJ4PSIxMC44NDgwMDciCiAgICAgICByeT0iMy44NDkyOTMyIiAvPgogICAgPGVsbGlwc2UKICAgICAgIHN0eWxlPSJvcGFjaXR5OjAuOTg2MDAwMDM7ZmlsbDojZDNiYzVmO2ZpbGwtb3BhY2l0eToxO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxMDtzdHJva2UtbGluZWNhcDpidXR0O3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2UtbWl0ZXJsaW1pdDo0O3N0cm9rZS1kYXNoYXJyYXk6bm9uZTtzdHJva2UtZGFzaG9mZnNldDowO3N0cm9rZS1vcGFjaXR5OjA7cGFpbnQtb3JkZXI6bm9ybWFsIgogICAgICAgaWQ9InBhdGg0NTU3IgogICAgICAgY3g9IjExMC4yMDc4OSIKICAgICAgIGN5PSIyMC4yMDQ1NTIiCiAgICAgICByeD0iMS4yMzcyMDk2IgogICAgICAgcnk9IjEuMTc1MzQ5MSIgLz4KICA8L2c+Cjwvc3ZnPgo=" alt="final mock-up design image"></p>
<p>So, once I have removed the backlight from the LCD’s I can mount them in a frame. I can then begin to control the contrast/pixel density to make them dim. I will then add a LDR to automate the brightness selection, this will remove the manual adjust however I will leave the buttons to set the levels. Next I will add a camera to the system so that the system can also detect bright points hence make a matching point darker on the lens. I will then use the buttons to make it so that you can swap between the modes. The final additional feature I would like to add is some intelligence on the camera side to ignore certain circumstances such as car tail/headlights.</p>
<h1 class="mume-header" id="report">Report</h1>

<p>I connected the LCD and displayed some random(size and location) spots of different opacity on the screen.</p>
<p><a href="log/IMG_1188.TRIM.MOV">random point video</a></p>
<h2 class="mume-header" id="lcd">LCD</h2>

<h3 class="mume-header" id="wiring">Wiring</h3>

<table>
<thead>
<tr>
<th>Function</th>
<th>Colour</th>
<th>Pi pins chip side</th>
<th>Pi pin</th>
<th>Colour</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>vcc</td>
<td>orange</td>
<td>17</td>
<td>18</td>
<td>grey</td>
<td>rs</td>
</tr>
<tr>
<td>sda</td>
<td>yellow</td>
<td>19</td>
<td>20</td>
<td>black/p</td>
<td>gnd</td>
</tr>
<tr>
<td></td>
<td>nc</td>
<td>21</td>
<td>22</td>
<td>blue</td>
<td>reset</td>
</tr>
<tr>
<td>scl</td>
<td>green</td>
<td>23</td>
<td>24</td>
<td>white</td>
<td>cs</td>
</tr>
</tbody>
</table>
<h2 class="mume-header" id="fov">FOV</h2>

<h3 class="mume-header" id="lcd-1">LCD</h3>

<p><img src="lcd/lcdfovcalc.png" alt="image"> 160x128 pixels</p>
<p>98.8 degrees horizontal, 86.05 degrees vertical field of view</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mn>1</mn><mn>2</mn><mn>8</mn></mrow><mrow><mn>8</mn><mn>6</mn><mi mathvariant="normal">.</mi><mn>0</mn><mn>5</mn></mrow></mfrac></mrow><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>4</mn><mn>8</mn><mtext> vertical pixels per degree</mtext></mrow><annotation encoding="application/x-tex">{ \frac {128} {86.05}} = 1.48 \text{ vertical pixels per degree}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">8</span><span class="mord">6</span><span class="mord">.</span><span class="mord">0</span><span class="mord">5</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.2em;"><svg width="400em" height="0.2em" viewbox="0 0 400000 200" preserveaspectratio="xMinYMin slice"><path d="M0 80H400000 v40H0z M0 80H400000 v40H0z"></path></svg></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">2</span><span class="mord">8</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">4</span><span class="mord">8</span><span class="mord text"><span class="mord"> vertical pixels per degree</span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mn>1</mn><mn>6</mn><mn>0</mn></mrow><mrow><mn>9</mn><mn>8</mn><mi mathvariant="normal">.</mi><mn>8</mn></mrow></mfrac></mrow><mo>=</mo><mn>1</mn><mi mathvariant="normal">.</mi><mn>6</mn><mn>2</mn><mtext> horizontal pixels per degree</mtext></mrow><annotation encoding="application/x-tex">{ \frac {160} {98.8}} = 1.62 \text{ horizontal pixels per degree}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span><span class="mord">8</span><span class="mord">.</span><span class="mord">8</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.2em;"><svg width="400em" height="0.2em" viewbox="0 0 400000 200" preserveaspectratio="xMinYMin slice"><path d="M0 80H400000 v40H0z M0 80H400000 v40H0z"></path></svg></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">6</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">6</span><span class="mord">2</span><span class="mord text"><span class="mord"> horizontal pixels per degree</span></span></span></span></span></span></p>
<h3 class="mume-header" id="camera">Camera</h3>

<p>2592x1944 pixels</p>
<p>53.50 degrees horizontal, 41.41 degrees vertical field of view</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mn>1</mn><mn>9</mn><mn>4</mn><mn>4</mn></mrow><mrow><mn>4</mn><mn>1</mn><mi mathvariant="normal">.</mi><mn>4</mn><mn>1</mn></mrow></mfrac></mrow><mo>=</mo><mn>4</mn><mn>6</mn><mi mathvariant="normal">.</mi><mn>9</mn><mn>5</mn><mtext> vertical pixels per degree</mtext></mrow><annotation encoding="application/x-tex">{ \frac {1944} {41.41}} = 46.95 \text{ vertical pixels per degree}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span><span class="mord">1</span><span class="mord">.</span><span class="mord">4</span><span class="mord">1</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.2em;"><svg width="400em" height="0.2em" viewbox="0 0 400000 200" preserveaspectratio="xMinYMin slice"><path d="M0 80H400000 v40H0z M0 80H400000 v40H0z"></path></svg></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">9</span><span class="mord">4</span><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">4</span><span class="mord">6</span><span class="mord">.</span><span class="mord">9</span><span class="mord">5</span><span class="mord text"><span class="mord"> vertical pixels per degree</span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mfrac><mrow><mn>1</mn><mn>6</mn><mn>0</mn></mrow><mrow><mn>9</mn><mn>8</mn><mi mathvariant="normal">.</mi><mn>8</mn></mrow></mfrac></mrow><mo>=</mo><mn>4</mn><mn>8</mn><mi mathvariant="normal">.</mi><mn>4</mn><mn>5</mn><mtext> vertical pixels per degree</mtext></mrow><annotation encoding="application/x-tex">{ \frac {160} {98.8}} = 48.45 \text{ vertical pixels per degree}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.32144em;"></span><span class="strut bottom" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="base"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">9</span><span class="mord">8</span><span class="mord">.</span><span class="mord">8</span></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3em;"></span><span class="stretchy" style="height:0.2em;"><svg width="400em" height="0.2em" viewbox="0 0 400000 200" preserveaspectratio="xMinYMin slice"><path d="M0 80H400000 v40H0z M0 80H400000 v40H0z"></path></svg></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">6</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mord rule" style="margin-right:0.2777777777777778em;"></span><span class="mord">4</span><span class="mord">8</span><span class="mord">.</span><span class="mord">4</span><span class="mord">5</span><span class="mord text"><span class="mord"> vertical pixels per degree</span></span></span></span></span></span></p>
<p>So this will cause issues since the dot placed on the LCD will end up then the wrong place with out scaling</p>
<h2 class="mume-header" id="frame">Frame</h2>

<p>I decided to laser cut the frame since this would be more cost/time effective. Also glasses frames tend to be fairly 2-dimensional. In the following image you can the the design iterations.<br>
Starting with a concept where I would heat the acrylic and bend at the red line meaning that you wouldn’t be able to fold them.<br>
After that you can see another fixed design but with a simpler shape this was the first iteration that actually got cut. I found that the lens was going to be to close to the eye and the ribbon cable from the lens was going to dig in to the brow of your nose. This was solved in the 3rd iteration by making the distance between the top of the frame and the top of the nose support forcing the user to wear the glasses further down their nose.<br>
After this I designed a hinging mechanism and readded the curves to make the glasses more comfortable. I also added a mounting bracket for the camera. This was the fame I cut and used for most of the prototyping phase of the project.<br>
For the next two design’s I was contemplating adding a backing plate to the pi mount and also added a mount for the capacitive touch sensor. This design was never cut since the pi 0 needs clearance for the solder of the pin headers and the backing might have added to much weight. Furthering the design of the hinge buy squaring of one end to make it more ridged and adding a hole to hold it together</p>
<p><img src="frame/devcycle.png" alt="image"></p>
<h2 class="mume-header" id="blob-detection">Blob detection</h2>

<p>I tried to install opencv to do the image processing but the install failed. After I spoke to my supervisor he confirmed my suspicion that opencv was too over powered for my project.</p>
<p>So I did some more research around low power blob detection in python and found Skimage which has a function for Determinant of Hessian(doh) blob detection. this was lightweight meaning it should be quick enough the only issue I then had was getting the image from the camera into the right format. Since the doh blob need a numpy array as luck would have it skimage has a built in converter.</p>
<p>With this working a passed it an image from the camera and save the image with a circle around the blob.</p>
<p><img src="log/blobbounding2.png" alt="blob circle"></p>
<p>I then connected the LCD and got blob detection working with that.</p>
<p><img src="log/IMG_1190.JPG" alt="blob lcd"></p>
<h2 class="mume-header" id="telegram">Telegram</h2>

<p>Then I started to convert the shades.py (the file that controls the lcd and camera) and telegrambot.py (the script that enables remote control via a chat client bot) this involved more work than I had initially expected since passing variable around wasn’t as easy as I had hoped.</p>
<p>I decided to use telegram to add remote control so that you could adjust the colour of the tint <a href="https://t.me/smartsheadsfypbot">remote control</a>.</p>
<h3 class="mume-header" id="commands">Commands</h3>

<table>
<thead>
<tr>
<th>Command</th>
<th>Parameters</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>help</td>
<td>n/a</td>
<td>Show the help menu.</td>
</tr>
<tr>
<td>pickcolour</td>
<td>pick from list of tints</td>
<td>Preset tints/colours.</td>
</tr>
<tr>
<td>pickmode</td>
<td>pick manual,tint,points or full auto</td>
<td>Change current mode.</td>
</tr>
<tr>
<td>tint</td>
<td>percentage</td>
<td>Sets the tint of the lenses.</td>
</tr>
<tr>
<td>image</td>
<td>n/a</td>
<td>Shows you the current image.</td>
</tr>
<tr>
<td>up</td>
<td>n/a</td>
<td>See if the bot is up.</td>
</tr>
<tr>
<td>temp</td>
<td>n/a</td>
<td>See the CPU temperature.</td>
</tr>
<tr>
<td>start</td>
<td>n/a</td>
<td>Starts shades.</td>
</tr>
<tr>
<td>stop</td>
<td>n/a</td>
<td>Stop shades.</td>
</tr>
<tr>
<td>exit</td>
<td>admin only</td>
<td>Exit shades.</td>
</tr>
<tr>
<td>reboot</td>
<td>admin only</td>
<td>Reboot shades.</td>
</tr>
<tr>
<td>halt</td>
<td>admin only</td>
<td>Shutdown shades.</td>
</tr>
<tr>
<td>uprecords</td>
<td>n/a</td>
<td>See up time.</td>
</tr>
<tr>
<td>debug</td>
<td>n/a</td>
<td>Toggles debug.</td>
</tr>
<tr>
<td>colourset</td>
<td>fore/back@0/255,0/255,0/255</td>
<td>Sets the colour of the lenses.</td>
</tr>
<tr>
<td>allowallids</td>
<td>admin only</td>
<td>Toggles if admin id is needed.</td>
</tr>
</tbody>
</table>
<p>After I had all of the system working I bought a 5 button capacitive touch sensor. I then started adding that into the code, So that I would be able to control the glasses with out having to have it connected to the internet.</p>
<h2 class="mume-header" id="capacitive-touch-sensor">Capacitive touch sensor</h2>

<h3 class="mume-header" id="wiring-1">Wiring</h3>

<table>
<thead>
<tr>
<th>Function</th>
<th>Colour</th>
<th>Pi pins chip side</th>
<th>Pi pin</th>
<th>Colour</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>3.3v</td>
<td>nc</td>
<td>1</td>
<td>2</td>
<td>nc</td>
<td>5v</td>
</tr>
<tr>
<td>button 1</td>
<td>orange</td>
<td>3</td>
<td>4</td>
<td>red</td>
<td>5v</td>
</tr>
<tr>
<td>button 2</td>
<td>yellow</td>
<td>5</td>
<td>6</td>
<td>black</td>
<td>gnd</td>
</tr>
<tr>
<td>button 3</td>
<td>green</td>
<td>7</td>
<td>8</td>
<td>blues</td>
<td>button 4</td>
</tr>
<tr>
<td>gnd</td>
<td>nc</td>
<td>9</td>
<td>10</td>
<td>purple</td>
<td>button 5</td>
</tr>
</tbody>
</table>
<h3 class="mume-header" id="buttons">Buttons</h3>

<table>
<thead>
<tr>
<th>Button</th>
<th>Colour</th>
<th>Pressed</th>
<th>Held</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>orange</td>
<td>scroll tints</td>
<td>reset tint to clear</td>
</tr>
<tr>
<td>2</td>
<td>yellow</td>
<td>scroll modes</td>
<td>reset to manual</td>
</tr>
<tr>
<td>3</td>
<td>green</td>
<td>debug</td>
<td>turn off</td>
</tr>
<tr>
<td>4</td>
<td>blue</td>
<td>stop</td>
<td>start</td>
</tr>
<tr>
<td>5</td>
<td>purple</td>
<td>n/a</td>
<td>exit</td>
</tr>
</tbody>
</table>
<h3 class="mume-header" id="capacitive-touch-control">Capacitive touch control</h3>

<p><a href="log/capmode.MOV">Mode change</a><br>
<a href="log/tint.MOV">Tint change</a><br>
<a href="log/debug.MOV">Debug toggle</a></p>
<h1 class="mume-header" id="criteria-met">Criteria met</h1>

<ul>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked> Make a set of smart sun classes.</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked> Add automatic to control the opacity.</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked> Add camera to make dark point over bright points.</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox" checked> Add options to swap between modes.</li>
<li class="task-list-item"><input type="checkbox" class="task-list-item-checkbox"> Auto react headlight/Safety improvements.</li>
</ul>
<p>I met all of my stage criteria except the reacting to headlights which I decided wasn’t a good idea since this could interfere with the drivers sight so will leave that mode out but I added other safety features like resetting of you hold the mode button and except for an catastrophic error the system is fail safe not deadly meaning it clears the LCD before exiting</p>
<p>I believe my project has meet at least level technology readiness level 4, Even pushing some level 5 criteria as defined by the European Commission.</p>
<table>
<thead>
<tr>
<th>level</th>
<th>definition</th>
</tr>
</thead>
<tbody>
<tr>
<td>TRL 1.</td>
<td>basic principles observed</td>
</tr>
<tr>
<td>TRL 2.</td>
<td>technology concept formulated</td>
</tr>
<tr>
<td>TRL 3.</td>
<td>experimental proof of concept</td>
</tr>
<tr>
<td>TRL 4.</td>
<td>technology validated in lab</td>
</tr>
<tr>
<td>TRL 5.</td>
<td>technology validated in relevant environment (industrially relevant environment in the case of key enabling technologies)</td>
</tr>
<tr>
<td>TRL 6.</td>
<td>technology demonstrated in relevant environment (industrially relevant environment in the case of key enabling technologies)</td>
</tr>
<tr>
<td>TRL 7.</td>
<td>system prototype demonstration in operational environment</td>
</tr>
<tr>
<td>TRL 8.</td>
<td>system complete and qualified</td>
</tr>
<tr>
<td>TRL 9.</td>
<td>actual system proven in operational environment (competitive manufacturing in the case of key enabling technologies; or in space)</td>
</tr>
</tbody>
</table>
<p>The European Association of Research and Technology Organisations (EARTO)<br>
have a slightly more relevant scale of TRL.</p>
<p><img src="TRLPROPODESED.png" alt="trl"></p>
<p>I still believe I’m level 4 with aspects of level 5 with this scale.</p>
<h1 class="mume-header" id="future-development">Future development</h1>

<p>My setup is mostly a proof of concept for a full prototype/production model I would use an FPGA with a low quality, high frame rate camera and a bare LCD. With that I would be able to increase the communication speed since the io is the limiting factor on the current setup.</p>
<p>Adding <a href="https://www.ttp.com/case-studies/electronic_lenses">prescription</a> while taking to course mates about my project one of them mentioned this research which could be a cool addition.</p>
<p><strong>&lt;&gt;</strong> by Jo Hawkins using <strong>Atom</strong> and <strong>GitHub</strong></p>
<h1 class="mume-header" id="appendix">Appendix</h1>

<h2 class="mume-header" id="telegrambotpy">telegrambot.py</h2>

<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token triple-quoted-string string">"""Telegram control file."""</span>
<span class="token keyword">import</span> os
<span class="token keyword">import</span> subprocess
<span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps
<span class="token keyword">from</span> random <span class="token keyword">import</span> choice<span class="token punctuation">,</span> randint
<span class="token keyword">from</span> time <span class="token keyword">import</span> strftime

<span class="token keyword">from</span> telegram <span class="token keyword">import</span> InlineKeyboardButton<span class="token punctuation">,</span> InlineKeyboardMarkup<span class="token punctuation">,</span> ParseMode
<span class="token keyword">from</span> telegram<span class="token punctuation">.</span>ext <span class="token keyword">import</span> <span class="token punctuation">(</span>CallbackQueryHandler<span class="token punctuation">,</span> CommandHandler<span class="token punctuation">,</span> Filters<span class="token punctuation">,</span>
                          MessageHandler<span class="token punctuation">,</span> Updater<span class="token punctuation">)</span>

<span class="token keyword">from</span> shades <span class="token keyword">import</span> <span class="token punctuation">(</span>debugset<span class="token punctuation">,</span> getiso<span class="token punctuation">,</span> modeset<span class="token punctuation">,</span> runningstateget<span class="token punctuation">,</span>
                    runningstateset<span class="token punctuation">,</span> sandd<span class="token punctuation">,</span> tintBackset<span class="token punctuation">,</span> tintShadeset<span class="token punctuation">)</span>

<span class="token comment"># program variables</span>
test_box_api_key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
test_box <span class="token operator">=</span> <span class="token number">0</span>
user <span class="token operator">=</span> <span class="token boolean">False</span>
admins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
allowAll <span class="token operator">=</span> <span class="token boolean">True</span>

jokelist <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'I cannot think of an ample joke currently'</span><span class="token punctuation">,</span>
    <span class="token string">'My friend told me how electricity is measured and I was like Watt! '</span><span class="token punctuation">,</span>
    <span class="token string">'Two antennas get married. The wedding was boring,'</span> <span class="token operator">+</span>
    <span class="token string">' but the reception was great.'</span><span class="token punctuation">,</span>
    <span class="token string">'Why was the robot mad? People kept pushing its buttons.'</span><span class="token punctuation">,</span>
    <span class="token string">'Why did Mr Ohm marry Mrs. Ohm? \n\r Because he couldnt resistor!'</span><span class="token punctuation">,</span>
    <span class="token string">'What kind of car does an electrician drive?\n\r A Volts-wagon'</span><span class="token punctuation">,</span>
    <span class="token string">'What is a robots favourite kind of music? \n\r Heavy Metal.'</span><span class="token punctuation">,</span>
    <span class="token string">'If only DEAD people understand hexadecimal,'</span> <span class="token operator">+</span>
    <span class="token string">' how many dead people are there?\n\r57,005.'</span><span class="token punctuation">,</span>
    <span class="token string">'What is FACE value in decimal?\n\r64206'</span><span class="token punctuation">,</span>
    <span class="token string">'I turned on the radio this morning all I heard was FFFFFF'</span> <span class="token operator">+</span>
    <span class="token string">'\n\r it turns out it was White Noise!'</span>
<span class="token punctuation">]</span>

<span class="token comment"># retrive telegram keys</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'telegramkeys.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
test_box_api_key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
admins<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> test_box_api_key
<span class="token keyword">print</span> admins

<span class="token comment"># Create the EventHandler and  it your bot's token.</span>
updater <span class="token operator">=</span> Updater<span class="token punctuation">(</span>test_box_api_key<span class="token punctuation">[</span>test_box<span class="token punctuation">]</span><span class="token punctuation">)</span>
jbq <span class="token operator">=</span> updater<span class="token punctuation">.</span>job_queue


<span class="token keyword">def</span> <span class="token function">restricted1</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Add re-stricter for access."""</span>
    @wraps<span class="token punctuation">(</span>func<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">wrapped</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        user_id <span class="token operator">=</span> update<span class="token punctuation">.</span>effective_user<span class="token punctuation">.</span><span class="token builtin">id</span>  <span class="token comment"># get user id</span>
        <span class="token keyword">if</span> allowAll <span class="token operator">or</span> user_id <span class="token keyword">in</span> admins<span class="token punctuation">:</span>  <span class="token comment"># if in open mode or admin id</span>
            <span class="token keyword">return</span> func<span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>  <span class="token comment"># run function</span>
        update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
            <span class="token string">"Access denied for {}.Ask [Jo](tg://user?id={}) for access."</span><span class="token punctuation">.</span>
            <span class="token builtin">format</span><span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> admins<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            parse_mode<span class="token operator">=</span>ParseMode<span class="token punctuation">.</span>MARKDOWN
        <span class="token punctuation">)</span>  <span class="token comment"># else echo access denied back to user</span>
        <span class="token keyword">return</span> <span class="token string">'error'</span>

    <span class="token keyword">return</span> wrapped


<span class="token keyword">def</span> <span class="token function">restricted2</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Add re-stricter for admin only access."""</span>
    @wraps<span class="token punctuation">(</span>func<span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">wrapped</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
        user_id <span class="token operator">=</span> update<span class="token punctuation">.</span>effective_user<span class="token punctuation">.</span><span class="token builtin">id</span>  <span class="token comment"># get user id</span>
        <span class="token keyword">if</span> user_id <span class="token keyword">in</span> admins<span class="token punctuation">:</span>  <span class="token comment"># if  admin id</span>
            <span class="token keyword">return</span> func<span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>  <span class="token comment"># run function</span>
        update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
            <span class="token string">"Access denied for {}.Ask [Jo](tg://user?id={}) for access."</span><span class="token punctuation">.</span>
            <span class="token builtin">format</span><span class="token punctuation">(</span>user_id<span class="token punctuation">,</span> admins<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            parse_mode<span class="token operator">=</span>ParseMode<span class="token punctuation">.</span>MARKDOWN
        <span class="token punctuation">)</span>  <span class="token comment"># else echo access denied back to user</span>
        <span class="token keyword">return</span> <span class="token string">'error'</span>

    <span class="token keyword">return</span> wrapped


<span class="token keyword">def</span> <span class="token function">time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Return time in formated string."""</span>
    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">(</span>strftime<span class="token punctuation">(</span><span class="token string">'%d/%m/%Y %H:%M:%S'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


@restricted2
<span class="token keyword">def</span> <span class="token function">spam</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Repetitive messages for debug."""</span>
    <span class="token keyword">if</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># if interval = 0</span>
        jbq<span class="token punctuation">.</span>run_once<span class="token punctuation">(</span>
            sendMessage<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                                     args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># initiate job to reply</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># for reppetive jobs</span>
        jbq<span class="token punctuation">.</span>run_repeating<span class="token punctuation">(</span>
            sendMessage<span class="token punctuation">,</span>
            interval<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            first<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>
            context<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># initiate job to repeat</span>


@restricted2
<span class="token keyword">def</span> <span class="token function">halt</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Turn off glasses."""</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
        <span class="token string">'Halting at {}'</span>
        <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># echo that command was received</span>
    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'sudo halt'</span><span class="token punctuation">)</span>  <span class="token comment"># send shutdown command</span>


@restricted2
<span class="token keyword">def</span> <span class="token function">reboot</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Reboot glasses."""</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
        <span class="token string">'Rebooting at {}'</span>
        <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># echo that command was received</span>
    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'sudo reboot'</span><span class="token punctuation">)</span>  <span class="token comment"># send reboot command</span>


@restricted2
<span class="token keyword">def</span> <span class="token function">allowallids</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Toggle restriction level."""</span>
    <span class="token keyword">global</span> allowAll  <span class="token comment"># pull allowAll in so function can edit</span>

    <span class="token keyword">if</span> allowAll<span class="token punctuation">:</span>  <span class="token comment"># toggle</span>
        allowAll <span class="token operator">=</span> <span class="token boolean">False</span>
        update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'allowing restricted ids.'</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        allowAll <span class="token operator">=</span> <span class="token boolean">True</span>
        update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'allowing all ids.'</span><span class="token punctuation">)</span>


@restricted2
<span class="token keyword">def</span> <span class="token function">exit</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Exit the program cleanly."""</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">1</span><span class="token punctuation">:</span>
        f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'run.txt'</span><span class="token punctuation">,</span> <span class="token string">'w+'</span><span class="token punctuation">)</span>  <span class="token comment"># open file</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># close file</span>
    runningstateset<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># set sate to exit</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'Exiting at {}'</span>
                              <span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># echo exiting back to user</span>


@restricted2
<span class="token keyword">def</span> <span class="token function">addwifi</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Add WiFi network."""</span>
    ssid <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    psk <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/etc/wpa_supplicant/wpa_supplicant.conf'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span>  <span class="token comment"># open file</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\nnetwork={\n        ssid="'</span><span class="token punctuation">)</span>  <span class="token comment"># format and store network</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ssid<span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'"\n        psk="'</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>psk<span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'"\n}\n'</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># close file</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
        <span class="token string">'added {} to wifi'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>ssid<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># echo added WiFi back to user</span>


@restricted1
<span class="token keyword">def</span> <span class="token function">image</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Send most recent image from camera."""</span>
    bot<span class="token punctuation">.</span>send_photo<span class="token punctuation">(</span>
        chat_id<span class="token operator">=</span>update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>chat_id<span class="token punctuation">,</span> photo<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'image1.jpg'</span><span class="token punctuation">,</span>
                                                   <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># send image</span>


@restricted1
<span class="token keyword">def</span> <span class="token function">start</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Start the glasses cleanly."""</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'users.txt'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span>  <span class="token comment"># currently debugging by logging new users</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'{}\n\r'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>from_user<span class="token punctuation">)</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    runningstateset<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># set state to running</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'started'</span><span class="token punctuation">)</span>  <span class="token comment"># echo started back to user</span>


@restricted1
<span class="token keyword">def</span> <span class="token function">stop</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Stop/pause glasses."""</span>
    runningstateset<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment"># set running state to stopped</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'stopped'</span><span class="token punctuation">)</span>  <span class="token comment"># echo stopped back to user</span>


@restricted1
<span class="token keyword">def</span> <span class="token function">mode</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Manually change the mode."""</span>
    modeset<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># set mode</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'mode set to {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
        args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># echo mode back to user</span>


@restricted1
<span class="token keyword">def</span> <span class="token function">colourset</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Set the colour of the lenses."""</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>colorSplit<span class="token punctuation">(</span>
        args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># colour information to handler</span>


@restricted1
<span class="token keyword">def</span> <span class="token function">autoback</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Calculate the background tint in manual mode."""</span>
    usrin <span class="token operator">=</span> getiso<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># get ambient light level</span>
    usrin <span class="token operator">=</span> <span class="token string">'back@{},{},{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
        <span class="token builtin">int</span><span class="token punctuation">(</span>usrin<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>usrin<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token builtin">int</span><span class="token punctuation">(</span>usrin<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># format string to be passed to handler</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>colorSplit<span class="token punctuation">(</span>usrin<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># string to handler</span>


@restricted1
<span class="token keyword">def</span> <span class="token function">tint</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Set background tint percentage."""</span>
    usrin <span class="token operator">=</span> <span class="token number">100</span> <span class="token operator">-</span> <span class="token builtin">int</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># invert percentage</span>
    usrin <span class="token operator">=</span> <span class="token string">'back@{},{},{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
        <span class="token builtin">int</span><span class="token punctuation">(</span>usrin <span class="token operator">*</span> <span class="token number">2.56</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>usrin <span class="token operator">*</span> <span class="token number">2.56</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token builtin">int</span><span class="token punctuation">(</span>usrin <span class="token operator">*</span> <span class="token number">2.56</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># format string to be passed to handler</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>colorSplit<span class="token punctuation">(</span>usrin<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># string to handler</span>


@restricted1
<span class="token keyword">def</span> <span class="token function">debug</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Toggle command line debug."""</span>
    debugset<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># toggle command line debug</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
        <span class="token string">'debug toggled'</span><span class="token punctuation">)</span>  <span class="token comment"># echo that the debug has been toggled back to user</span>


<span class="token keyword">def</span> <span class="token function">uprecords</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Run the uprecords command and echo results."""</span>
    p <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>Popen<span class="token punctuation">(</span>
        <span class="token punctuation">[</span><span class="token string">'uprecords'</span><span class="token punctuation">,</span> <span class="token string">'-a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE<span class="token punctuation">,</span> stderr<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>PIPE
    <span class="token punctuation">)</span>  <span class="token comment"># open subprocess in thread and pipe back results</span>
    out <span class="token operator">=</span> p<span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># collect results</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>out<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># echo results</span>


<span class="token keyword">def</span> <span class="token function">temp</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Get cpu temperature."""</span>
    temp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/sys/class/thermal/thermal_zone0/temp'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000.0</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'CPU temperature is:{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">joke</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Send a joke."""</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>choice<span class="token punctuation">(</span>jokelist<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># pick random joke and send</span>


<span class="token keyword">def</span> <span class="token function">meme</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Send a meme."""</span>
    memeid <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span>  <span class="token comment"># pick random image</span>
    bot<span class="token punctuation">.</span>send_photo<span class="token punctuation">(</span>
        chat_id<span class="token operator">=</span>update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>chat_id<span class="token punctuation">,</span>
        photo<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'memes/{}.jpg'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>memeid<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># send image</span>


<span class="token keyword">def</span> <span class="token function">help</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Display help menu."""</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
        <span class="token string">'help im stuck in a box \n\r'</span> <span class="token operator">+</span>
        <span class="token string">'/pickcolour - pick from list of tints\n\r'</span> <span class="token operator">+</span>
        <span class="token string">'/pickmode- manual,tint,points or full auto\n\r'</span> <span class="token operator">+</span>
        <span class="token string">'/tint percentage\n\r'</span> <span class="token operator">+</span> <span class="token string">'/colourset fore-back@0-255,0-255,0-255\n\r'</span> <span class="token operator">+</span>
        <span class="token string">'/start starts shades\n\r'</span> <span class="token operator">+</span> <span class="token string">'/stop stop shades\n\r'</span> <span class="token operator">+</span>
        <span class="token string">'for more info check the [site](git.djh1997.uk)'</span><span class="token punctuation">,</span>
        parse_mode<span class="token operator">=</span>ParseMode<span class="token punctuation">.</span>MARKDOWN<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">up</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Check if glasses are online."""</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'shades {} is online.'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>test_box<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">echo</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Catch all for unrecognised commands."""</span>
    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span><span class="token string">'command {} not recognised.'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
        update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># echo that the command was unrecognised</span>
    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'log.txt'</span><span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">)</span>  <span class="token comment"># log the user id and message</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'{} : '</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'{}\n\r'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>from_user<span class="token punctuation">)</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">pickcolour</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Inline keyboard to pick a preset colour."""</span>
    keyboard <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"50"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"80"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"90"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"100"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"red"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">101</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"green"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">102</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"blue"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">103</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"gold"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">104</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment"># setup layout</span>

    reply_markup <span class="token operator">=</span> InlineKeyboardMarkup<span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>  <span class="token comment"># create keyboard</span>

    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
        <span class="token string">'Please choose:'</span><span class="token punctuation">,</span> reply_markup<span class="token operator">=</span>reply_markup<span class="token punctuation">)</span>  <span class="token comment"># send keyboard</span>


<span class="token keyword">def</span> <span class="token function">pickmode</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Inline keyboard to pick mode."""</span>
    keyboard <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"manual"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"tint"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"point"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        InlineKeyboardButton<span class="token punctuation">(</span><span class="token string">"full auto"</span><span class="token punctuation">,</span> callback_data<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token comment"># setup layout</span>

    reply_markup <span class="token operator">=</span> InlineKeyboardMarkup<span class="token punctuation">(</span>keyboard<span class="token punctuation">)</span>  <span class="token comment"># create keyboard</span>

    update<span class="token punctuation">.</span>message<span class="token punctuation">.</span>reply_text<span class="token punctuation">(</span>
        <span class="token string">'Please choose:'</span><span class="token punctuation">,</span> reply_markup<span class="token operator">=</span>reply_markup<span class="token punctuation">)</span>  <span class="token comment"># send keyboard</span>


<span class="token keyword">def</span> <span class="token function">button</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> update<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Create handler for inline keyboard."""</span>
    query <span class="token operator">=</span> update<span class="token punctuation">.</span>callback_query
    tint <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>query<span class="token punctuation">.</span>data<span class="token punctuation">)</span>  <span class="token comment"># convert button id to int</span>
    <span class="token keyword">if</span> tint <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">:</span>  <span class="token comment"># if mode button</span>
        modeset<span class="token punctuation">(</span>tint<span class="token punctuation">)</span>  <span class="token comment"># set mode</span>
        bot<span class="token punctuation">.</span>edit_message_text<span class="token punctuation">(</span>
            text<span class="token operator">=</span><span class="token string">"mode set to {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tint<span class="token punctuation">)</span><span class="token punctuation">,</span>
            chat_id<span class="token operator">=</span>query<span class="token punctuation">.</span>message<span class="token punctuation">.</span>chat_id<span class="token punctuation">,</span>
            message_id<span class="token operator">=</span>query<span class="token punctuation">.</span>message<span class="token punctuation">.</span>message_id<span class="token punctuation">)</span>  <span class="token comment"># echo new mode</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># if tint setting</span>
        <span class="token keyword">if</span> tint <span class="token operator">&lt;=</span> <span class="token number">100</span><span class="token punctuation">:</span>  <span class="token comment"># if standard tint</span>
            tint <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tint <span class="token operator">*</span> <span class="token number">2.55</span><span class="token punctuation">)</span>  <span class="token comment"># format tint</span>
            tint <span class="token operator">=</span> <span class="token string">'{},{},{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tint<span class="token punctuation">,</span> tint<span class="token punctuation">,</span> tint<span class="token punctuation">)</span>  <span class="token comment"># format tint</span>
        <span class="token keyword">elif</span> tint <span class="token operator">==</span> <span class="token number">101</span><span class="token punctuation">:</span>  <span class="token comment"># if colour tint</span>
            tint <span class="token operator">=</span> <span class="token string">'255, 200, 200'</span>  <span class="token comment"># red</span>
        <span class="token keyword">elif</span> tint <span class="token operator">==</span> <span class="token number">102</span><span class="token punctuation">:</span>
            tint <span class="token operator">=</span> <span class="token string">'200, 255, 200'</span>  <span class="token comment"># green</span>
        <span class="token keyword">elif</span> tint <span class="token operator">==</span> <span class="token number">103</span><span class="token punctuation">:</span>
            tint <span class="token operator">=</span> <span class="token string">'200, 200, 255'</span>  <span class="token comment"># blue</span>
        <span class="token keyword">elif</span> tint <span class="token operator">==</span> <span class="token number">104</span><span class="token punctuation">:</span>
            tint <span class="token operator">=</span> <span class="token string">'255, 223, 0'</span>  <span class="token comment"># gold</span>
        bot<span class="token punctuation">.</span>edit_message_text<span class="token punctuation">(</span>
            text<span class="token operator">=</span><span class="token string">"Selected option: {}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                colorSplit<span class="token punctuation">(</span><span class="token string">'back@{}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tint<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            chat_id<span class="token operator">=</span>query<span class="token punctuation">.</span>message<span class="token punctuation">.</span>chat_id<span class="token punctuation">,</span>
            message_id<span class="token operator">=</span>query<span class="token punctuation">.</span>message<span class="token punctuation">.</span>message_id<span class="token punctuation">)</span>  <span class="token comment"># set tint and echo result</span>


<span class="token keyword">def</span> <span class="token function">colorSplit</span><span class="token punctuation">(</span>usrin<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Colour handler."""</span>
    error <span class="token operator">=</span> <span class="token boolean">False</span>
    usrin <span class="token operator">=</span> usrin<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'@'</span><span class="token punctuation">)</span>  <span class="token comment"># split colour and location</span>
    tint <span class="token operator">=</span> usrin<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>  <span class="token comment"># split colours</span>
    reply <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tint<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># iterate over rgb values</span>
        tint<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tint<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># convert to int</span>
        <span class="token keyword">if</span> tint<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">not</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">257</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># check value is in valid range</span>
            reply <span class="token operator">=</span> <span class="token string">'rgb out of range'</span>  <span class="token comment"># warn user of error</span>
            error <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># trigger error</span>
    <span class="token keyword">if</span> error <span class="token keyword">is</span> <span class="token boolean">False</span><span class="token punctuation">:</span>  <span class="token comment"># if all values in spec</span>
        <span class="token keyword">if</span> usrin<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'back'</span><span class="token punctuation">:</span>  <span class="token comment"># set background tint</span>
            tintBackset<span class="token punctuation">(</span>tint<span class="token punctuation">)</span>  <span class="token comment"># data to handler</span>
            reply <span class="token operator">=</span> tint  <span class="token comment"># echo back the rgb values</span>
        <span class="token keyword">elif</span> usrin<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'fore'</span><span class="token punctuation">:</span>  <span class="token comment"># set foreground tint</span>
            tintShadeset<span class="token punctuation">(</span>tint<span class="token punctuation">)</span>  <span class="token comment"># data to handler</span>
            reply <span class="token operator">=</span> tint  <span class="token comment"># echo back the rgb values</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># if not fore or back warn user and show formatting</span>
            reply <span class="token operator">=</span> <span class="token string">'valueError format like this fore-back@0-255,0-255,0-255'</span>
    <span class="token keyword">return</span> reply


<span class="token keyword">def</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span>bot<span class="token punctuation">,</span> job<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Send message handler for job_queue."""</span>
    bot<span class="token punctuation">.</span>send_message<span class="token punctuation">(</span>chat_id<span class="token operator">=</span>job<span class="token punctuation">.</span>context<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> text<span class="token operator">=</span>job<span class="token punctuation">.</span>context<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">telegramMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Telegram main function."""</span>
    <span class="token keyword">global</span> updater

    <span class="token comment"># Get the dispatcher to register handlers</span>
    dp <span class="token operator">=</span> updater<span class="token punctuation">.</span>dispatcher

    <span class="token comment"># on different commands - answer in Telegram</span>
    <span class="token comment"># all</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"help"</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"uprecords"</span><span class="token punctuation">,</span> uprecords<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"up"</span><span class="token punctuation">,</span> up<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"temp"</span><span class="token punctuation">,</span> temp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">'joke'</span><span class="token punctuation">,</span> joke<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">'meme'</span><span class="token punctuation">,</span> meme<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># togglable</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">,</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"stop"</span><span class="token punctuation">,</span> stop<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"mode"</span><span class="token punctuation">,</span> mode<span class="token punctuation">,</span> pass_args<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"autoback"</span><span class="token punctuation">,</span> autoback<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"tint"</span><span class="token punctuation">,</span> tint<span class="token punctuation">,</span> pass_args<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"colourset"</span><span class="token punctuation">,</span> colourset<span class="token punctuation">,</span> pass_args<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">'pickcolour'</span><span class="token punctuation">,</span> pickcolour<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">'pickmode'</span><span class="token punctuation">,</span> pickmode<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">'image'</span><span class="token punctuation">,</span> image<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">'debug'</span><span class="token punctuation">,</span> debug<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># admins only</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"exit"</span><span class="token punctuation">,</span> exit<span class="token punctuation">,</span> pass_args<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">'spam'</span><span class="token punctuation">,</span> spam<span class="token punctuation">,</span> pass_args<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">'allowallids'</span><span class="token punctuation">,</span> allowallids<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"halt"</span><span class="token punctuation">,</span> halt<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"reboot"</span><span class="token punctuation">,</span> reboot<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CommandHandler<span class="token punctuation">(</span><span class="token string">"addwifi"</span><span class="token punctuation">,</span> addwifi<span class="token punctuation">,</span> pass_args<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># keyboard handler</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>CallbackQueryHandler<span class="token punctuation">(</span>button<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># on noncommand i.e message - echo the message on Telegram</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>MessageHandler<span class="token punctuation">(</span>Filters<span class="token punctuation">.</span>text<span class="token punctuation">,</span> echo<span class="token punctuation">)</span><span class="token punctuation">)</span>
    dp<span class="token punctuation">.</span>add_handler<span class="token punctuation">(</span>MessageHandler<span class="token punctuation">(</span>Filters<span class="token punctuation">.</span>command<span class="token punctuation">,</span> echo<span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># Start the Bot</span>
    updater<span class="token punctuation">.</span>start_polling<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment"># Run the bot until you press Ctrl-C or the process receives SIGINT,</span>
    <span class="token comment"># SIGTERM or SIGABRT. This should be used most of the time, since</span>
    <span class="token comment"># start_polling() is non-blocking and will stop the bot gracefully.</span>
    jbq<span class="token punctuation">.</span>run_once<span class="token punctuation">(</span>sendMessage<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> context<span class="token operator">=</span><span class="token punctuation">[</span>
                 admins<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'Shades booting at {}'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> runningstateget<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> runningstateget<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
            runningstateset<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
            sandd<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># updater.idle()</span>
    updater<span class="token punctuation">.</span>stop<span class="token punctuation">(</span><span class="token punctuation">)</span>


telegramMain<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre><h2 class="mume-header" id="shadespy">shades.py</h2>

<pre data-role="codeBlock" data-info="python" class="language-python"><span class="token triple-quoted-string string">"""Pi0to chromic control file."""</span>
<span class="token keyword">import</span> os
<span class="token keyword">from</span> time <span class="token keyword">import</span> sleep<span class="token punctuation">,</span> time

<span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image

<span class="token keyword">import</span> Adafruit_GPIO<span class="token punctuation">.</span>SPI <span class="token keyword">as</span> SPI
<span class="token keyword">import</span> ST7735 <span class="token keyword">as</span> TFT
<span class="token keyword">from</span> gpiozero <span class="token keyword">import</span> Button
<span class="token keyword">from</span> picamera <span class="token keyword">import</span> PiCamera  <span class="token comment"># camera</span>
<span class="token keyword">from</span> skimage<span class="token punctuation">.</span>feature <span class="token keyword">import</span> blob_doh  <span class="token comment"># blob detection</span>
<span class="token keyword">from</span> skimage<span class="token punctuation">.</span>io <span class="token keyword">import</span> imread  <span class="token comment"># convert jpg to np array</span>

<span class="token comment"># screen variables</span>
WIDTH <span class="token operator">=</span> <span class="token number">128</span>
HEIGHT <span class="token operator">=</span> <span class="token number">160</span>
SPEED_HZ <span class="token operator">=</span> <span class="token number">125000000</span>

scaleFactor <span class="token operator">=</span> <span class="token number">.25</span>

<span class="token comment"># Raspberry Pi configuration.</span>
DC <span class="token operator">=</span> <span class="token number">24</span>
RST <span class="token operator">=</span> <span class="token number">25</span>
SPI_PORT <span class="token operator">=</span> <span class="token number">0</span>
SPI_DEVICE <span class="token operator">=</span> <span class="token number">0</span>

<span class="token comment"># program variables</span>
processpoint <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'clear'</span><span class="token punctuation">,</span> <span class="token string">'display'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'autoback'</span><span class="token punctuation">,</span> <span class="token string">'clear'</span><span class="token punctuation">,</span> <span class="token string">'display'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string">'take'</span><span class="token punctuation">,</span> <span class="token string">'convert'</span><span class="token punctuation">,</span> <span class="token string">'blob find'</span><span class="token punctuation">,</span> <span class="token string">'blob to point'</span><span class="token punctuation">,</span> <span class="token string">'clear'</span><span class="token punctuation">,</span> <span class="token string">'point maths'</span><span class="token punctuation">,</span>
    <span class="token string">'display'</span>
<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
    <span class="token string">'autoback'</span><span class="token punctuation">,</span> <span class="token string">'take'</span><span class="token punctuation">,</span> <span class="token string">'convert'</span><span class="token punctuation">,</span> <span class="token string">'blob find'</span><span class="token punctuation">,</span> <span class="token string">'blob to point'</span><span class="token punctuation">,</span> <span class="token string">'clear'</span><span class="token punctuation">,</span>
    <span class="token string">'point maths'</span><span class="token punctuation">,</span> <span class="token string">'display'</span>
<span class="token punctuation">]</span><span class="token punctuation">]</span>
averageFps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
running <span class="token operator">=</span> <span class="token number">0</span>
tintShade <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">]</span>
tintBack <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">]</span>
tintbuttonvar <span class="token operator">=</span> <span class="token number">255</span>
mode <span class="token operator">=</span> <span class="token number">0</span>
debug <span class="token operator">=</span> <span class="token number">0</span>
disp <span class="token operator">=</span> <span class="token number">0</span>
draw <span class="token operator">=</span> <span class="token number">0</span>
camera <span class="token operator">=</span> <span class="token number">0</span>
new <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token comment"># button connection</span>
buttonTint <span class="token operator">=</span> Button<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
buttonMode <span class="token operator">=</span> Button<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
buttonDebug <span class="token operator">=</span> Button<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> hold_time<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>
buttonReset <span class="token operator">=</span> Button<span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">,</span> hold_time<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>
buttonexit <span class="token operator">=</span> Button<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> hold_time<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">initlcd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Initilize the lcd's."""</span>
    <span class="token keyword">global</span> disp<span class="token punctuation">,</span> draw
    <span class="token keyword">print</span> <span class="token string">'initializing LCD'</span>
    disp <span class="token operator">=</span> TFT<span class="token punctuation">.</span>ST7735<span class="token punctuation">(</span>
        DC<span class="token punctuation">,</span>
        rst<span class="token operator">=</span>RST<span class="token punctuation">,</span>
        spi<span class="token operator">=</span>SPI<span class="token punctuation">.</span>SpiDev<span class="token punctuation">(</span>SPI_PORT<span class="token punctuation">,</span> SPI_DEVICE<span class="token punctuation">,</span>
                       max_speed_hz<span class="token operator">=</span>SPEED_HZ<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># setup SPI port</span>
    disp<span class="token punctuation">.</span>begin<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># start screen class</span>
    disp<span class="token punctuation">.</span>display<span class="token punctuation">(</span>
        Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'pi0toChroma.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rotate<span class="token punctuation">(</span><span class="token number">270</span><span class="token punctuation">)</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span>
            Image<span class="token punctuation">.</span>FLIP_TOP_BOTTOM<span class="token punctuation">)</span><span class="token punctuation">.</span>resize<span class="token punctuation">(</span><span class="token punctuation">(</span>WIDTH<span class="token punctuation">,</span>
                                           HEIGHT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># draw splash screen</span>
    draw <span class="token operator">=</span> disp<span class="token punctuation">.</span>draw<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># put splash screen on LCD's</span>
    <span class="token keyword">print</span> <span class="token string">'LCD initialized'</span>


<span class="token keyword">def</span> <span class="token function">deinitlcd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Deinitilise the lcd."""</span>
    <span class="token keyword">global</span> disp
    disp<span class="token punctuation">.</span>display<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'close.jpg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rotate<span class="token punctuation">(</span><span class="token number">90</span><span class="token punctuation">)</span><span class="token punctuation">.</span>resize<span class="token punctuation">(</span>
        <span class="token punctuation">(</span>WIDTH<span class="token punctuation">,</span> HEIGHT<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># display close screen</span>
    sleep<span class="token punctuation">(</span><span class="token number">.5</span><span class="token punctuation">)</span>
    disp<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># set LCD to clear</span>
    disp<span class="token punctuation">.</span>display<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token string">'LCD cleared'</span>


<span class="token keyword">def</span> <span class="token function">initcamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Initilize the camera."""</span>
    <span class="token keyword">global</span> camera
    <span class="token keyword">print</span> <span class="token string">'initializing camera'</span>
    camera <span class="token operator">=</span> PiCamera<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># open camera</span>
    camera<span class="token punctuation">.</span>color_effects <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">)</span>  <span class="token comment"># set camera to grey scale</span>
    camera<span class="token punctuation">.</span>resolution <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">160</span> <span class="token operator">*</span> scaleFactor<span class="token punctuation">)</span><span class="token punctuation">,</span>
                         <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">128</span> <span class="token operator">*</span> scaleFactor<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># set resolution to screens</span>
    camera<span class="token punctuation">.</span>rotation <span class="token operator">=</span> <span class="token number">270</span>  <span class="token comment"># correct orinetation</span>
    camera<span class="token punctuation">.</span>vflip <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">if</span> debug <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># if debug was called before camera initialization was run</span>
        camera<span class="token punctuation">.</span>start_preview<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># start camera preview</span>
    sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>  <span class="token comment"># wait for camera to stabilise</span>
    <span class="token keyword">print</span> <span class="token string">'camera initialized'</span>


<span class="token keyword">def</span> <span class="token function">deinitcamera</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Disconnect camera so the next instance of the program can access."""</span>
    <span class="token keyword">global</span> camera
    camera<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span> <span class="token string">'camera closed'</span>


<span class="token keyword">def</span> <span class="token function">debugset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Toggle debug."""</span>
    <span class="token keyword">global</span> debug
    <span class="token keyword">if</span> camera <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># check if camera initialization has been run</span>
        <span class="token keyword">if</span> debug <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># toggle preview</span>
            camera<span class="token punctuation">.</span>start_preview<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            camera<span class="token punctuation">.</span>stop_preview<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token comment"># if camera initialization hasn't  been run print warning</span>
        <span class="token keyword">print</span> <span class="token string">'camera not defined yet'</span>

    debug <span class="token operator">^</span><span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># toggle debug</span>
    <span class="token keyword">if</span> debug <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># print new debug state</span>
        <span class="token keyword">print</span> <span class="token string">'debug on'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token string">'debug off'</span>


<span class="token keyword">def</span> <span class="token function">runningstateset</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Set running state."""</span>
    <span class="token keyword">global</span> running
    <span class="token keyword">try</span><span class="token punctuation">:</span>  <span class="token comment"># try assuming state is a button</span>
        <span class="token keyword">if</span> state<span class="token punctuation">.</span>pin<span class="token punctuation">.</span>number <span class="token operator">==</span> <span class="token number">14</span> <span class="token operator">and</span> state<span class="token punctuation">.</span>is_held<span class="token punctuation">:</span>  <span class="token comment"># if button is held</span>
            state <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># set state to running</span>
        <span class="token keyword">elif</span> state<span class="token punctuation">.</span>pin<span class="token punctuation">.</span>number <span class="token operator">==</span> <span class="token number">14</span><span class="token punctuation">:</span>  <span class="token comment"># if state button is pressed</span>
            state <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># set state to stopped</span>
        <span class="token keyword">elif</span> state<span class="token punctuation">.</span>pin<span class="token punctuation">.</span>number <span class="token operator">==</span> <span class="token number">15</span> <span class="token operator">and</span> state<span class="token punctuation">.</span>is_held<span class="token punctuation">:</span>  <span class="token comment"># if button is held</span>
            state <span class="token operator">=</span> <span class="token number">2</span>  <span class="token comment"># set state to exit</span>
    <span class="token keyword">except</span> AttributeError<span class="token punctuation">:</span>  <span class="token comment"># catch not button error</span>
        <span class="token keyword">print</span> <span class="token string">'not button'</span>  <span class="token comment"># print warning</span>
    <span class="token keyword">print</span> <span class="token string">'state '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span>  <span class="token comment"># print new state</span>
    running <span class="token operator">=</span> state  <span class="token comment"># set state</span>


<span class="token keyword">def</span> <span class="token function">tintShadeset</span><span class="token punctuation">(</span>tint<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Set Shade tint."""</span>
    <span class="token keyword">global</span> tintShade
    tintShade <span class="token operator">=</span> tint  <span class="token comment"># set tint level for active shade points</span>


<span class="token keyword">def</span> <span class="token function">autoshadeset</span><span class="token punctuation">(</span>tintdifference<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Set shade point tint unsing background and difference."""</span>
    <span class="token keyword">global</span> tintShade
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tintShade<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        tintShade<span class="token punctuation">[</span>
            i<span class="token punctuation">]</span> <span class="token operator">=</span> tintBack<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">-</span> tintdifference  <span class="token comment"># set tint difference points</span>


<span class="token keyword">def</span> <span class="token function">tintBackset</span><span class="token punctuation">(</span>tint<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Set background tint."""</span>
    <span class="token keyword">global</span> tintBack<span class="token punctuation">,</span> new
    tintBack <span class="token operator">=</span> tint  <span class="token comment"># set tint level for background</span>
    new <span class="token operator">=</span> <span class="token boolean">True</span>


<span class="token keyword">def</span> <span class="token function">tintButton</span><span class="token punctuation">(</span>buttonTint<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Set the background tint based on button presses."""</span>
    <span class="token keyword">global</span> tintBack<span class="token punctuation">,</span> tintbuttonvar
    <span class="token keyword">if</span> buttonTint<span class="token punctuation">.</span>is_held <span class="token operator">or</span> tintbuttonvar <span class="token operator">&lt;</span> <span class="token number">64</span><span class="token punctuation">:</span>  <span class="token comment"># if button is held reset</span>
        tintbuttonvar <span class="token operator">=</span> <span class="token number">256</span>  <span class="token comment"># set tint to clear</span>
    <span class="token keyword">elif</span> tintbuttonvar <span class="token operator">>=</span> <span class="token number">64</span><span class="token punctuation">:</span>  <span class="token comment"># increment tint if not at limit</span>
        tintbuttonvar <span class="token operator">-=</span> <span class="token number">64</span>
    tintBackset<span class="token punctuation">(</span>tintbuttonvar<span class="token punctuation">)</span>  <span class="token comment"># set tint</span>
    <span class="token keyword">print</span> tintBack


<span class="token keyword">def</span> <span class="token function">modeset</span><span class="token punctuation">(</span>modevar<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""0 manual 1 tint 2 point 3 auto 4 increment."""</span>
    <span class="token keyword">global</span> mode<span class="token punctuation">,</span> averageFps<span class="token punctuation">,</span> new
    <span class="token keyword">try</span><span class="token punctuation">:</span>  <span class="token comment"># try assuming modevar is a button</span>
        <span class="token keyword">if</span> modevar<span class="token punctuation">.</span>pin<span class="token punctuation">.</span>number <span class="token operator">==</span> <span class="token number">3</span> <span class="token operator">and</span> modevar<span class="token punctuation">.</span>is_held<span class="token punctuation">:</span>  <span class="token comment"># if button is held</span>
            modevar <span class="token operator">=</span> <span class="token number">0</span>  <span class="token comment"># reset mode to manual</span>
        <span class="token keyword">elif</span> modevar<span class="token punctuation">.</span>pin<span class="token punctuation">.</span>number <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>  <span class="token comment"># if mode button is pressed</span>
            <span class="token keyword">if</span> mode <span class="token operator">>=</span> <span class="token number">3</span><span class="token punctuation">:</span>  <span class="token comment"># if at limit the reset to manual</span>
                modevar <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># else increment</span>
                modevar <span class="token operator">=</span> mode <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token keyword">except</span> AttributeError<span class="token punctuation">:</span>  <span class="token comment"># catch not button error</span>
        <span class="token keyword">print</span> <span class="token string">'not button'</span>  <span class="token comment"># print warning</span>
    mode <span class="token operator">=</span> modevar  <span class="token comment"># set mode</span>
    <span class="token keyword">print</span> <span class="token string">'mode '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>mode<span class="token punctuation">)</span>  <span class="token comment"># display new mode</span>
    averageFps <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># reset average fps array</span>
    new <span class="token operator">=</span> <span class="token boolean">True</span>


<span class="token keyword">def</span> <span class="token function">runningstateget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Return current state."""</span>
    <span class="token keyword">global</span> running
    <span class="token keyword">return</span> running


<span class="token keyword">def</span> <span class="token function">getiso</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Get iso level of sensor.."""</span>
    <span class="token keyword">global</span> camera
    maxtint <span class="token operator">=</span> <span class="token number">4</span>
    iso <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>camera<span class="token punctuation">.</span>analog_gain<span class="token punctuation">)</span>  <span class="token comment"># get current ambient brightness 0..8</span>
    iso <span class="token operator">=</span> <span class="token punctuation">(</span>iso <span class="token operator">*</span> maxtint<span class="token punctuation">)</span>  <span class="token comment"># adjust buy max tint level</span>
    iso <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">256</span> <span class="token operator">-</span> <span class="token punctuation">(</span>maxtint <span class="token operator">*</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> iso  <span class="token comment"># clear - max tint + ISO tint</span>
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>iso<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">halt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Halt the system."""</span>
    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">'sudo halt'</span><span class="token punctuation">)</span>  <span class="token comment"># send halt command to terminal</span>


<span class="token keyword">def</span> <span class="token function">initbuttons</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Initilize buttons.

    Wait for all button to be released
    Then asign to correct function.
    """</span>
    buttonTint<span class="token punctuation">.</span>wait_for_release<span class="token punctuation">(</span>
    <span class="token punctuation">)</span>  <span class="token comment"># wait incase any of the buttons are locked high</span>
    buttonMode<span class="token punctuation">.</span>wait_for_release<span class="token punctuation">(</span><span class="token punctuation">)</span>
    buttonDebug<span class="token punctuation">.</span>wait_for_release<span class="token punctuation">(</span><span class="token punctuation">)</span>
    buttonReset<span class="token punctuation">.</span>wait_for_release<span class="token punctuation">(</span><span class="token punctuation">)</span>
    buttonexit<span class="token punctuation">.</span>wait_for_release<span class="token punctuation">(</span><span class="token punctuation">)</span>
    buttonTint<span class="token punctuation">.</span>when_pressed <span class="token operator">=</span> tintButton  <span class="token comment"># set button state to function</span>
    buttonTint<span class="token punctuation">.</span>when_held <span class="token operator">=</span> tintButton
    buttonMode<span class="token punctuation">.</span>when_pressed <span class="token operator">=</span> modeset
    buttonMode<span class="token punctuation">.</span>when_held <span class="token operator">=</span> modeset
    buttonDebug<span class="token punctuation">.</span>when_pressed <span class="token operator">=</span> debugset
    <span class="token comment"># buttonDebug.when_held = halt</span>
    buttonReset<span class="token punctuation">.</span>when_pressed <span class="token operator">=</span> runningstateset
    buttonReset<span class="token punctuation">.</span>when_held <span class="token operator">=</span> runningstateset
    <span class="token comment"># buttonexit.when_held = runningstateset</span>


<span class="token keyword">def</span> <span class="token function">sandd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Pi0t0 chromic main function.

    This handles the main running of the shades.
    This is done by having nested while loops to control different states.
    Then there is if statments to control weather the system reactes to the
    camera or not, and how to update the lenses
    """</span>
    <span class="token keyword">global</span> averageFps<span class="token punctuation">,</span> new
    initlcd<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># initialize peripherals</span>
    initbuttons<span class="token punctuation">(</span><span class="token punctuation">)</span>
    initcamera<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> running <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>  <span class="token comment"># exit state</span>
        <span class="token keyword">while</span> running <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">and</span> new<span class="token punctuation">:</span>  <span class="token comment"># running state and new</span>
            timer <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>  <span class="token comment"># reset internal variables</span>
            points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
            modeinternal <span class="token operator">=</span> mode

            <span class="token keyword">if</span> <span class="token punctuation">(</span>modeinternal <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">or</span> <span class="token punctuation">(</span>
                    modeinternal <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># if mode with auto background tint</span>
                timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>
                ti <span class="token operator">=</span> getiso<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># get light level</span>
                tintBackset<span class="token punctuation">(</span><span class="token punctuation">[</span>ti<span class="token punctuation">,</span> ti<span class="token punctuation">,</span> ti<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># calculate background tint</span>
                <span class="token keyword">if</span> modeinternal <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
                    autoshadeset<span class="token punctuation">(</span>ti<span class="token punctuation">)</span>

            <span class="token keyword">if</span> modeinternal <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>  <span class="token comment"># if active point shading mode</span>
                timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>

                camera<span class="token punctuation">.</span>capture<span class="token punctuation">(</span>
                    <span class="token string">'image1.jpg'</span><span class="token punctuation">,</span> use_video_port<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                    thumbnail<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>  <span class="token comment"># capture image</span>

                timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>
                img1 <span class="token operator">=</span> imread<span class="token punctuation">(</span><span class="token string">'image1.jpg'</span><span class="token punctuation">,</span> as_grey<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

                timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>
                blobs_doh <span class="token operator">=</span> blob_doh<span class="token punctuation">(</span>
                    img1<span class="token punctuation">,</span> max_sigma<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">,</span> threshold<span class="token operator">=</span><span class="token number">.0075</span><span class="token punctuation">)</span>  <span class="token comment"># find blobs</span>

                timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>

                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>blobs_doh<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># calculate points from blobs</span>
                    points<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>
                        blobs_doh<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">/</span> scaleFactor<span class="token punctuation">,</span>
                        blobs_doh<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> scaleFactor<span class="token punctuation">,</span>
                        <span class="token punctuation">(</span>blobs_doh<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> scaleFactor<span class="token punctuation">,</span> tintShade
                    <span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># x,y,r,tint</span>

            timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>

            disp<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">(</span>tintBack<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> tintBack<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                        tintBack<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># set background tint</span>

            <span class="token keyword">if</span> modeinternal <span class="token operator">>=</span> <span class="token number">2</span><span class="token punctuation">:</span>  <span class="token comment"># if active point shading mode</span>
                timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>
                               <span class="token builtin">len</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># convert x,y,r to bounding box</span>
                    x1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    x2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    y1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    y2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    draw<span class="token punctuation">.</span>ellipse<span class="token punctuation">(</span>
                        <span class="token punctuation">(</span>x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">,</span>
                        fill<span class="token operator">=</span><span class="token punctuation">(</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                              points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># draw</span>

            timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>

            disp<span class="token punctuation">.</span>display<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># put the drawing on the the LCD's</span>

            timer<span class="token punctuation">.</span>append<span class="token punctuation">(</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># add timer point</span>

            <span class="token keyword">if</span> modeinternal <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment"># if in mode 0 then toggle new</span>
                new <span class="token operator">=</span> <span class="token boolean">False</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                new <span class="token operator">=</span> <span class="token boolean">True</span>

            <span class="token keyword">if</span> debug <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>  <span class="token comment"># if debug is on the print timings</span>

                <span class="token keyword">print</span> <span class="token string">'number of points: {}\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token string">'points:{}\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token string">'background tint: {}\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tintBack<span class="token punctuation">)</span>
                <span class="token keyword">print</span> <span class="token string">'foreground tint: {}\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>tintShade<span class="token punctuation">)</span>
                <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>
                               <span class="token builtin">len</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token operator">-</span>
                               <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># iterate over timing list to get timings</span>
                    <span class="token keyword">print</span> <span class="token string">'function {} : time {}\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                        processpoint<span class="token punctuation">[</span>modeinternal<span class="token punctuation">]</span><span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">,</span>
                        timer<span class="token punctuation">[</span>t <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> timer<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># print function and time</span>

                totaltime <span class="token operator">=</span> timer<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
                                  <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> timer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># calculate total time</span>
                averageFps<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">/</span> totaltime<span class="token punctuation">)</span>  <span class="token comment"># calculate fps and append</span>
                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>averageFps<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">11</span><span class="token punctuation">:</span>  <span class="token comment"># buffer has min number of values</span>
                    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>averageFps<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">61</span><span class="token punctuation">:</span>  <span class="token comment"># buffer full then remove oldest</span>
                        averageFps<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token keyword">print</span> <span class="token string">'average fps = {: 4.2f}\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                        <span class="token builtin">sum</span><span class="token punctuation">(</span>averageFps<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">len</span><span class="token punctuation">(</span>averageFps<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># print average fps</span>
                <span class="token keyword">print</span> <span class="token string">'total = {: 4.2f}  fps = {: 4.2f}\n'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>
                    totaltime<span class="token punctuation">,</span> averageFps<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>averageFps<span class="token punctuation">)</span>
                                          <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># print total time and fps</span>

        sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    deinitlcd<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># close peripherals</span>
    deinitcamera<span class="token punctuation">(</span><span class="token punctuation">)</span>
</pre></div>
      </div>
      <div class="md-sidebar-toc"><ul>
<li><a href="#final-year-project"><strong>Final Year Project</strong></a></li>
<li><a href="#stage-criteria">Stage Criteria</a>
<ul>
<li><a href="#inspiration">Inspiration</a></li>
<li><a href="#plan">Plan</a></li>
</ul>
</li>
<li><a href="#final-mock-up">Final mock-up</a></li>
<li><a href="#report">Report</a>
<ul>
<li><a href="#lcd">LCD</a>
<ul>
<li><a href="#wiring">Wiring</a></li>
</ul>
</li>
<li><a href="#fov">FOV</a>
<ul>
<li><a href="#lcd-1">LCD</a></li>
<li><a href="#camera">Camera</a></li>
</ul>
</li>
<li><a href="#frame">Frame</a></li>
<li><a href="#blob-detection">Blob detection</a></li>
<li><a href="#telegram">Telegram</a>
<ul>
<li><a href="#commands">Commands</a></li>
</ul>
</li>
<li><a href="#capacitive-touch-sensor">Capacitive touch sensor</a>
<ul>
<li><a href="#wiring-1">Wiring</a></li>
<li><a href="#buttons">Buttons</a></li>
<li><a href="#capacitive-touch-control">Capacitive touch control</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#criteria-met">Criteria met</a></li>
<li><a href="#future-development">Future development</a></li>
<li><a href="#appendix">Appendix</a>
<ul>
<li><a href="#telegrambotpy">telegrambot.py</a></li>
<li><a href="#shadespy">shades.py</a></li>
</ul>
</li>
</ul>
</div>
      <a id="sidebar-toc-btn">≡</a>
    </body>







<script>

var sidebarTOCBtn = document.getElementById('sidebar-toc-btn')
sidebarTOCBtn.addEventListener('click', function(event) {
  event.stopPropagation()
  if (document.body.hasAttribute('html-show-sidebar-toc')) {
    document.body.removeAttribute('html-show-sidebar-toc')
  } else {
    document.body.setAttribute('html-show-sidebar-toc', true)
  }
})
</script>

  </html>
